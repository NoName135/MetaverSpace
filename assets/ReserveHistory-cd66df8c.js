import{a as b,l as k,_ as g,o,c as n,b as e,F as w,g as $,t as d,f as m,d as c,w as R,j as C,r as h,n as f,h as L}from"./index-6d712d14.js";import{s as E}from"./swal-e4da1902.js";const B={props:["reserves"],methods:{deleteReserve(t){this.$swal.fire({title:"取消預約",text:`確定要取消 ${new Date(t.reserve_time).toLocaleString("zh-TW",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})} 的預約？`,icon:"warning",confirmButtonColor:"#FE5F50",confirmButtonText:"確定取消",backdrop:" rgba(0,0,0,0.8)",showCancelButton:!0,cancelButtonColor:"#6b7280"}).then(i=>{i.isConfirmed&&(this.loadings.fullLoading=!0,this.$http.delete(`https://metarverspace-server.onrender.com/reserves/${t.id}`).then(()=>{this.$emit("update-reserves",t.id),this.loadings.fullLoading=!1}).catch(a=>{this.loadings.fullLoading=!1,this.userToast("error",a.message)}))})}},computed:{...b(k,["loadings"])}},S={key:0,class:"text-center text-2xl md:text-3xl mb-10"},T={key:1,class:"mb-10"},V={class:"relative overflow-x-auto sm:rounded-lg"},D={class:"w-full text-sm text-left"},z=e("thead",{class:"uppercase bg-white/20 text-gray-300"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},"預約時間"),e("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},"門市"),e("th",{scope:"col",class:"px-4 py-3 whitespace-nowrap"},"預約人數"),e("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},"預約人姓名"),e("th",{scope:"col",class:"px-5 py-3 whitespace-nowrap"},"預約狀態"),e("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},[e("span",{class:"sr-only"},"選項")])])],-1),q={class:"border-b bg-gray-800 border-gray-700"},F={scope:"row",class:"px-6 py-4 font-medium whitespace-nowrap text-white"},M={class:"px-6 py-4 whitespace-nowrap"},N={class:"px-4 py-4 whitespace-nowrap"},j={class:"px-6 py-4 whitespace-nowrap"},H={class:"px-5 py-4 whitespace-nowrap"},U={class:"px-5 py-4 whitespace-nowrap flex justify-center"},W=["onClick"];function A(t,i,a,l,r,p){return a.reserves.length?(o(),n("div",T,[e("div",V,[e("table",D,[z,(o(!0),n(w,null,$(a.reserves,s=>(o(),n("tbody",{key:s.id,class:"text-sm text-gray-400"},[e("tr",q,[e("th",F,d(new Date(s.reserve_time).toLocaleString("zh-TW",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})),1),e("td",M,d(s.title),1),e("td",N,d(s.num),1),e("td",j,d(s.name),1),e("td",H,d(s.is_reserve?"預約成功":"尚未確認"),1),e("td",U,[s.is_reserve?m("",!0):(o(),n("button",{key:0,type:"button",class:"text-white right-1.5 bottom-1.5 focus:ring-1 focus:outline-none font-medium rounded text-sm px-4 py-2 bg-warm hover:bg-warm2 focus:ring-warm2",onClick:u=>p.deleteReserve(s)}," 取消預約 ",8,W))])])]))),128))])])])):(o(),n("p",S," 沒有任何預約記錄 "))}const O=g(B,[["render",A]]),G={mixins:[E],data(){return{searchLoading:!1,reserves:[],filterReserves:[]}},methods:{getReserves(t){const i=t.姓名.trim(),a=t.電話或Email.trim();this.searchLoading=!0,this.$http.get("https://metarverspace-server.onrender.com/reserves").then(l=>{this.reserves=l.data,this.filterReserves=this.reserves.filter(r=>r.name===i&&(r.email===a||r.tel===a)),this.searchLoading=!1}).catch(l=>{this.searchLoading=!1,this.userToast("error",l.message)})},updateReserves(t){this.filterReserves=this.filterReserves.filter(i=>i.id!==t),this.userToast("success","取消預約成功")}},components:{ReserveDetail:O}},I={class:"mt-nav"},J={class:"container px-2 md:px-0 pt-8"},K={class:"border-2 rounded-lg overflow-hidden"},P=e("h1",{class:"p-4 bg-black/50 text-xl font-bold border-b-2"},"預約記錄",-1),Q={class:"px-8"},X={class:"py-8 flex justify-center"},Y=e("label",{for:"name",class:"block mb-2 text-sm font-medium text-white"},"姓名",-1),Z={class:"mt-8"},ee=e("label",{for:"phoneOrEmail",class:"block mb-2 text-sm font-medium text-white"},"電話或Email",-1),se=["disabled"],te={key:0,class:"animate-spin h-5 w-5 mr-3 text-white absolute",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},re=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),oe=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),ae=[re,oe],ne={key:0,class:"my-20 border-b border-2"};function ie(t,i,a,l,r,p){const s=h("V-field"),u=h("ErrorMessage"),x=h("V-form"),v=h("ReserveDetail"),y=h("ScrollTop");return o(),n(w,null,[e("div",I,[e("div",J,[e("div",K,[P,e("div",Q,[e("div",X,[c(x,{class:"w-96",ref:"form",onSubmit:p.getReserves},{default:R(({errors:_})=>[e("div",null,[Y,c(s,{type:"text",id:"name",name:"姓名",class:f(["border text-sm rounded-lg block w-full p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-primary focus:border-primary",{"border-warm":_.姓名}]),rules:"required",placeholder:"請輸入姓名",required:""},null,8,["class"]),c(u,{name:"姓名",class:"text-warm text-sm"})]),e("div",Z,[ee,c(s,{type:"text",id:"name",name:"電話或Email",class:f(["border text-sm rounded-lg block w-full p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-primary focus:border-primary",{"border-warm":_.電話或Email}]),rules:"required",placeholder:"請輸入電話或Email",required:""},null,8,["class"]),c(u,{name:"電話或Email",class:"text-warm text-sm"})]),e("button",{type:"submit",class:"mt-12 primary-button w-full relative",disabled:r.searchLoading},[r.searchLoading?(o(),n("svg",te,ae)):m("",!0),L(" 預約查詢 ")],8,se)]),_:1},8,["onSubmit"])])])]),r.reserves.length?(o(),n("div",ne)):m("",!0),r.reserves.length?(o(),C(v,{key:1,reserves:r.filterReserves,onUpdateReserves:p.updateReserves},null,8,["reserves","onUpdateReserves"])):m("",!0)])]),c(y)],64)}const de=g(G,[["render",ie]]);export{de as default};
