import{N as E,S as H,a as R}from"./navigation.min-e9cc9c04.js";import{_ as B,m as L,a as w,l as G,c as l,b as e,d as p,w as m,t as n,F as u,g as _,f as h,i as x,v as F,h as k,n as M,r as g,o as i,j as C,s as z,x as q,y as D}from"./index-727fbaff.js";import{c as A}from"./cartStore-7450e7eb.js";import{f as j}from"./favoriteStore-7a0d908d.js";import{s as O}from"./swal-e4da1902.js";const{VITE_API:f,VITE_PATH:b}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"metaverspace",VITE_RENDER_API:"https://metarverspace-server.onrender.com",BASE_URL:"/MetaverSpace/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},X={mixins:[O],data(){return{product:{},otherProducts:[],accessories:[],cartSpec:"",qty:1,cart_specs:[],productModules:[E],targetImage:""}},methods:{getProduct(r){this.loadings.fullLoading=!0,this.$http.get(`${f}/api/${b}/product/${r}`).then(o=>{this.product=o.data.product,this.targetImage=this.product.imageUrl,this.getOtherProducts(),this.product.accessory?this.getAccessory():this.loadings.fullLoading=!1}).catch(o=>{this.loadings.fullLoading=!1,this.userToast("error",o.response.data.message)})},async getOtherProducts(){if(this.otherProducts=[],this.product.category==="配件")try{const r=await this.$http.get(`${f}/api/${b}/products?category=配件`);this.otherProducts=r.data.products}catch(r){this.userToast("error",r.response.data.message)}else{const r=["AR","VR","MR","XR"];try{await Promise.all(r.map(async o=>{const a=await this.$http.get(`${f}/api/${b}/products?category=${o}`);this.otherProducts.push(...a.data.products)}))}catch(o){this.userToast("error",o.message)}}this.otherProducts.forEach((r,o)=>{r.id===this.product.id&&this.otherProducts.splice(o,1)})},async getAccessory(){const r=this.product.accessory.map(o=>this.$http.get(`${f}/api/${b}/product/${o.id}`));try{const o=await Promise.allSettled(r);this.accessories=o.filter(a=>a.status==="fulfilled").map(a=>a.value.data.product),this.cart_specs=this.accessories.map(a=>({id:a.id,spec:"",qty:1,check:!1})),this.loadings.fullLoading=!1}catch(o){this.loadings.fullLoading=!1,this.userToast("error",o.response.data.message)}this.loadings.fullLoading=!1},changeImg(r){this.targetImage=r},...L(A,["getCart","addCart"]),...L(j,["updateFavorite"])},computed:{...w(G,["loadings"]),...w(A,["cart","cartLoading"]),...w(j,["favorites"])},watch:{qty(){this.qty<1&&(this.qty=1),this.qty>99&&(this.qty=99)},"$route.params.id"(){this.$route.fullPath.includes("/product/")&&this.getProduct(this.$route.params.id)}},mounted(){this.getProduct(this.$route.params.id)},components:{Swiper:H,SwiperSlide:R}},J={class:"mt-nav"},K={class:"container grid grid-cols-1 lg:grid-cols-2 gap-7 pt-8 px-2 md:px-0"},Q=["src"],W=["src"],Y=["onMouseover"],Z=["src","alt"],$={class:"flex flex-col"},ee={class:"flex items-center"},se={class:"col-span-2 text-2xl mr-3"},te={class:"bg-white/30 px-3.5 py-2 rounded text-sm"},oe={class:"mt-2 text-3xl font-bold"},re={class:"mt-3 text-md"},ie=["innerHTML"],ce={class:"flex-auto flex flex-col justify-end"},le={class:"flex justify-between items-center mt-6"},ne={class:"flex items-end"},de={class:"text-primary text-2xl font-bold"},ae={class:"ml-2 line-through"},pe=e("p",{class:"ml-2 hidden sm:block text-xl"},"已加入收藏",-1),ue=e("p",{class:"ml-2 hidden sm:block text-xl"},"未加入收藏",-1),he={key:0,class:"flex flex-wrap items-center mt-8"},me=e("h5",{class:"text-lg mr-4 mb-6"},"規格：",-1),_e={class:"flex flex-wrap text-sm"},ge=["id","value"],xe=["for"],fe={key:1,class:"text-sm"},be={class:"sm:flex items-center mt-4"},ye={class:"flex items-center"},ve={class:"flex"},we=["disabled"],ke=["disabled"],Pe=["disabled"],Ve={key:0,class:"animate-spin h-5 w-5 mr-3 text-white absolute",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Se=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),Te=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),Ie=[Se,Te],Le={key:0,class:"mt-8 bg-black/50 px-2 md:px-0"},Me={class:"container py-8"},Ce=e("h3",{class:"text-xl font-bold pb-3 border-b"},"加購配件",-1),qe={class:"flex flex-wrap mt-4 px-2"},Ae={class:"bg-white"},je=["src","alt"],Ne={class:"flex flex-col px-2 py-4 h-[calc(100%-192px)]"},Ue={class:"text-lg font-bold"},Ee=["innerHTML"],He={class:"flex-auto flex flex-col justify-end"},Re={key:0,class:"text-sm mt-4"},Be=["onUpdate:modelValue"],Ge=e("option",{selected:"",disabled:"",value:"",class:"bg-white/10"}," 選擇規格 ",-1),Fe=["value"],ze={key:1,class:"w-full"},De=["onUpdate:modelValue"],Oe=D('<option selected value="1" class="bg-white/10">1</option><option value="2" class="bg-white/10">2</option><option value="3" class="bg-white/10">3</option><option value="4" class="bg-white/10">4</option><option value="5" class="bg-white/10">5</option>',5),Xe=[Oe],Je={class:"flex justify-between items-end mt-4"},Ke={class:"text-xl font-bold text-primary"},Qe=["disabled","onClick"],We={key:0,class:"animate-spin h-3 w-3 mr-1 text-white absolute top-3 left-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ye=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),Ze=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),$e=[Ye,Ze],es={class:"container py-8"},ss=e("h3",{class:"text-xl font-bold pb-3 mb-4 border-b"},"商品詳細資訊",-1),ts=["innerHTML"],os=["src","alt"],rs={class:"container mt-8 px-2 md:px-0"},is=e("h3",{class:"text-xl font-bold pb-3 mb-4 border-b"},"您可能也喜歡",-1),cs={class:"h-full"},ls=["src","alt"],ns={class:"absolute top-4 left-4"},ds={class:"bg-dark px-2 py-1 rounded-sm text-white text-xs mr-1"},as={class:"p-3 md:p-5 h-1/2 flex flex-col justify-between rounded-b",style:{background:`linear-gradient(
                  142.88deg,
                  rgba(255, 255, 255, 0.16) 8.09%,
                  rgba(255, 255, 255, 0.064) 27.24%,
                  rgba(255, 255, 255, 0.064) 34.42%,
                  rgba(255, 255, 255, 0.1088) 48.78%,
                  rgba(255, 255, 255, 0) 100%
                )`}},ps={class:"text-white"},us={class:"text-left"},hs={class:"text-lg font-bold ellipse2 mb-2"},ms=["innerHTML"],_s={class:"flex flex-col justify-end"},gs={class:"whitespace-nowrap mb-2"},xs={class:"flex justify-between items-center"},fs={class:"text-gray-400 line-through text-xs"},bs={class:"text-md font-bold"},ys={class:"text-end"};function vs(r,o,a,ws,s,P){var S,T,I;const y=g("swiper-slide"),V=g("swiper"),v=g("FontAwesomeIcon"),N=g("RouterLink"),U=g("ScrollTop");return i(),l(u,null,[e("div",J,[e("div",K,[e("div",null,[e("img",{src:s.targetImage,class:"h-[240px] sm:h-[360px] xl:h-[480px] object-contain mx-auto bg-white rounded",alt:"商品圖片"},null,8,Q),p(V,{ref:"productSwiper",slidesPerView:3,slidesPerGroup:3,breakpoints:{480:{slidesPerView:4,slidesPerGroup:4},768:{slidesPerView:5,slidesPerGroup:5},976:{slidesPerView:4,slidesPerGroup:4},1440:{slidesPerView:5,slidesPerGroup:5}},spaceBetween:30,navigation:!0,modules:s.productModules,class:"productSwiper mt-6 !px-8 sm:!px-16 xl:!px-24"},{default:m(()=>[p(y,null,{default:m(()=>[e("div",{class:"cursor-pointer",onMouseover:o[0]||(o[0]=t=>P.changeImg(s.product.imageUrl))},[e("img",{class:"h-12 xs:h-16 md:h-20 lg:h-16 xl:h-20 object-contain rounded-sm mx-auto bg-white border-2 hover:border-primary",src:s.product.imageUrl,alt:"商品主要圖片"},null,8,W)],32)]),_:1}),(i(!0),l(u,null,_(s.product.imagesUrl,(t,c)=>(i(),C(y,{key:c},{default:m(()=>[e("div",{class:"cursor-pointer",onMouseover:d=>P.changeImg(t)},[e("img",{class:"h-12 xs:h-16 md:h-20 lg:h-16 xl:h-20 object-contain mx-auto rounded-sm bg-white border-2 hover:border-primary",src:t,alt:`商品圖片${c}`},null,8,Z)],40,Y)]),_:2},1024))),128))]),_:1},8,["modules"])]),e("section",$,[e("div",ee,[e("h4",se,n(s.product.brand),1),e("div",te,n(s.product.category),1)]),e("h3",oe,n(s.product.title),1),e("div",re,[e("div",{class:"prose prose-front prose-styles leading-relaxed",innerHTML:s.product.description},null,8,ie)]),e("div",ce,[e("div",le,[e("div",ne,[e("p",de," NT$ "+n(r.$filters.currency(s.product.price)),1),e("p",ae," NT$ "+n(r.$filters.currency(s.product.origin_price)),1)]),r.favorites.some(t=>t.id===s.product.id)?(i(),l("div",{key:0,class:"flex items-center cursor-pointer text-primary2",onClick:o[1]||(o[1]=t=>r.updateFavorite(s.product))},[p(v,{icon:["fas","heart"],class:"text-2xl"}),pe])):(i(),l("div",{key:1,class:"flex items-center cursor-pointer hover:text-primary",onClick:o[2]||(o[2]=t=>r.updateFavorite(s.product))},[p(v,{icon:["fas","heart"],class:"text-2xl"}),ue]))]),s.product.spec?(i(),l("div",he,[me,e("ul",_e,[(i(!0),l(u,null,_(s.product.spec,(t,c)=>(i(),l("li",{class:"mb-6",key:c},[x(e("input",{type:"radio",id:`spec${c}`,name:"spec",class:"hidden peer",value:t,"onUpdate:modelValue":o[3]||(o[3]=d=>s.cartSpec=d),required:""},null,8,ge),[[z,s.cartSpec]]),e("label",{for:`spec${c}`,class:"mr-3 bg-black hover:bg-primary2 peer-checked:bg-primary peer-checked:hover:bg-primary2 peer-checked:ring-1 peer-checked:ring-white px-3 py-2 rounded cursor-pointer"},n(t),9,xe)]))),128))])])):h("",!0),(S=s.product.spec)!=null&&S.length?(i(),l("p",fe," ※ 選擇規格後才能加入購物車 ")):h("",!0),e("div",be,[e("div",ye,[e("div",ve,[e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-l text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:o[4]||(o[4]=t=>s.qty-=1),disabled:s.qty===1}," － ",8,we),x(e("input",{type:"number",class:"w-12 bg-dark text-sm text-center focus:border-secondary",min:"1",max:"99","onUpdate:modelValue":o[5]||(o[5]=t=>s.qty=t)},null,512),[[F,s.qty,void 0,{lazy:!0}]]),e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-r text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:o[6]||(o[6]=t=>s.qty+=1),disabled:s.qty===99}," ＋ ",8,ke)])]),e("button",{type:"button",class:"w-full primary-button sm:ml-2 mt-4 sm:mt-0 relative",disabled:r.cartLoading.cartId===s.product.id||((T=s.product.spec)!=null&&T.length?!s.cartSpec:!1),onClick:o[7]||(o[7]=t=>r.addCart(s.product,s.qty,s.cartSpec))},[r.cartLoading.cartId===s.product.id?(i(),l("svg",Ve,Ie)):h("",!0),k(" 加入購物車 ")],8,Pe)])])])]),s.product.accessory?(i(),l("section",Le,[e("div",Me,[Ce,e("div",qe,[(i(!0),l(u,null,_(s.accessories,(t,c)=>(i(),l("div",{class:"border rounded w-64 mt-6 mx-3",key:t.id},[e("div",Ae,[e("img",{src:t.imageUrl,alt:`配件圖片${c}`,class:"w-full h-48 object-contain object-center bg-white"},null,8,je)]),e("div",Ne,[e("h4",Ue,n(t.title),1),e("div",{class:"mt-4 text-md",innerHTML:t.description},null,8,Ee),e("div",He,[t.spec?(i(),l("p",Re,"※請先選擇規格")):h("",!0),e("div",{class:M(["flex items-center",[t.spec?" mt-2":" mt-6"]])},[t.spec?x((i(),l("select",{key:0,id:"accessorySpec1",class:"border text-sm rounded w-full p-2 bg-gray-600 border-gray-500 text-white focus:ring-primary focus:border-ring-primary","onUpdate:modelValue":d=>s.cart_specs[c].spec=d},[Ge,(i(!0),l(u,null,_(t.spec,d=>(i(),l("option",{class:"bg-white/10",key:d,value:d},n(d),9,Fe))),128))],8,Be)),[[q,s.cart_specs[c].spec]]):(i(),l("p",ze,"選擇數量：")),x(e("select",{id:"accessoryNum1",class:"ml-1 border text-sm rounded p-2 bg-gray-600 border-gray-500 text-white focus:ring-primary focus:border-ring-primary w-24","onUpdate:modelValue":d=>s.cart_specs[c].qty=d},Xe,8,De),[[q,s.cart_specs[c].qty,void 0,{number:!0}]])],2),e("div",Je,[e("p",Ke," NT$ "+n(r.$filters.currency(t.price)),1),e("button",{type:"button",class:"w-20 px-0 py-2 primary-button sm:ml-2 mt-4 sm:mt-0 relative",disabled:r.cartLoading.cartId===s.cart_specs[c].id||t.spec&&!s.cart_specs[c].spec,onClick:d=>r.addCart(s.accessories[c],s.cart_specs[c].qty,s.cart_specs[c].spec)},[r.cartLoading.cartId===s.cart_specs[c].id?(i(),l("svg",We,$e)):h("",!0),k(" 加購 ")],8,Qe)])])])]))),128))])])])):h("",!0),s.product.content||(I=s.product.contentImages)!=null&&I.length?(i(),l("section",{key:1,class:M(["bg-black/50 px-2 md:px-0",{"mt-8":!s.product.accessory}])},[e("div",es,[ss,e("div",{class:"prose prose-front prose-styles leading-loose",innerHTML:s.product.content},null,8,ts),(i(!0),l(u,null,_(s.product.contentImages,(t,c)=>(i(),l("img",{key:c,src:t,alt:`商品詳細圖片${c}`,class:"mt-4 mx-auto rounded lg:rounded-lg w-full max-w-4xl"},null,8,os))),128))])],2)):h("",!0),e("section",rs,[is,p(V,{ref:"productSwiper",slidesPerView:1,slidesPerGroup:1,breakpoints:{768:{slidesPerView:2,slidesPerGroup:2},976:{slidesPerView:3,slidesPerGroup:3},1440:{slidesPerView:4,slidesPerGroup:4}},spaceBetween:30,navigation:!0,modules:s.productModules,class:"productSwiper mt-6 !px-8 sm:!px-16 xl:!px-24 h-[420px]"},{default:m(()=>[(i(!0),l(u,null,_(s.otherProducts,(t,c)=>(i(),C(y,{key:t.id},{default:m(()=>[e("div",cs,[e("img",{class:"h-1/2 w-full object-cover bg-white rounded-t relative",src:t.imageUrl,alt:`其他商品圖片${c}`},null,8,ls),e("div",ns,[e("div",ds,n(t.brand),1)]),e("div",as,[e("div",ps,[e("div",us,[e("h5",hs,n(t.title),1),e("p",{class:"text-sm ellipse2 prose prose-front prose-styles leading-normal",innerHTML:t.description},null,8,ms)])]),e("div",_s,[e("div",gs,[e("div",xs,[e("p",fs," NT$ "+n(r.$filters.currency(t.origin_price)),1),e("p",bs," NT$ "+n(r.$filters.currency(t.price)),1)])]),e("div",ys,[p(N,{to:`/product/${t.id}`,class:"text-primary hover:underline"},{default:m(()=>[k(" 了解詳情 "),p(v,{icon:["fas","chevron-right"]})]),_:2},1032,["to"])])])])])]),_:2},1024))),128))]),_:1},8,["modules"])])]),p(U)],64)}const Is=B(X,[["render",vs]]);export{Is as default};
