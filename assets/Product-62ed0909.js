import{N as H,S as R,a as B}from"./navigation.min-d6139c35.js";import{_ as E,m as M,a as w,l as G,x as z,c,b as e,d as p,w as m,t as n,F as u,g as _,f as h,i as x,v as F,h as k,n as C,r as g,o as i,j as I,s as D,y as q,z as O}from"./index-5c013917.js";import{c as j}from"./cartStore-8575235c.js";import{f as A}from"./favoriteStore-46671ede.js";import{s as X}from"./swal-e4da1902.js";const{VITE_API:f,VITE_PATH:b}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"metaverspace",BASE_URL:"/MetaverSpace",MODE:"production",DEV:!1,PROD:!0,SSR:!1},J={mixins:[X],data(){return{product:{},otherProducts:[],accessories:[],cartSpec:"",qty:1,cart_specs:[],productModules:[H],targetImage:""}},methods:{getProduct(r){this.loadings.fullLoading=!0,this.$http.get(`${f}/api/${b}/product/${r}`).then(o=>{this.product=o.data.product,this.targetImage=this.product.imageUrl,this.getOtherProducts(),this.product.accessory?this.getAccessory():this.loadings.fullLoading=!1}).catch(o=>{this.loadings.fullLoading=!1,this.userToast("error",o.response.data.message)})},async getOtherProducts(){if(this.otherProducts=[],this.product.category==="配件")await this.$http.get(`${f}/api/${b}/products?category=配件`).then(r=>{this.otherProducts=r.data.products}).catch(r=>{this.userToast("error",r.response.data.message)});else{const r=["AR","VR","MR","XR"];try{await Promise.all(r.map(async o=>{const a=await this.$http.get(`${f}/api/${b}/products?category=${o}`);this.otherProducts.push(...a.data.products)}))}catch(o){this.userToast("error",o.message)}}this.otherProducts.forEach((r,o)=>{r.id===this.product.id&&this.otherProducts.splice(o,1)})},async getAccessory(){const r=this.product.accessory.map(o=>this.$http.get(`${f}/api/${b}/product/${o.id}`));try{const o=await Promise.allSettled(r);this.accessories=o.filter(a=>a.status==="fulfilled").map(a=>a.value.data.product),this.cart_specs=this.accessories.map(a=>({id:a.id,spec:"",qty:1,check:!1})),this.loadings.fullLoading=!1}catch(o){this.loadings.fullLoading=!1,this.userToast("error",o.response.data.message)}this.loadings.fullLoading=!1},changeImg(r){this.targetImage=r},...M(j,["getCart","addCart"]),...M(A,["updateFavorite"])},computed:{...w(G,["loadings"]),...w(j,["cart","cartLoading"]),...w(A,["favorites"])},watch:{qty(){this.qty<1&&(this.qty=1),this.qty>99&&(this.qty=99)},"$route.params.id"(){this.$route.fullPath.includes("/product/")&&this.getProduct(this.$route.params.id)}},mounted(){this.getProduct(this.$route.params.id)},components:{Swiper:R,SwiperSlide:B,FontAwesomeIcon:z}},K={class:"mt-nav"},Q={class:"container grid grid-cols-1 lg:grid-cols-2 gap-7 pt-8 px-2 md:px-0"},W=["src"],Y=["src"],Z=["onMouseover"],$=["src"],ee={class:"flex flex-col"},se={class:"flex items-center"},te={class:"col-span-2 text-2xl mr-3"},oe={class:"bg-white/30 px-3.5 py-2 rounded text-sm"},re={class:"mt-2 text-3xl font-bold"},ie={class:"mt-3 text-md"},ce=["innerHTML"],le={class:"flex-auto flex flex-col justify-end"},ne={class:"flex justify-between items-center mt-6"},de={class:"flex items-end"},ae={class:"text-primary text-2xl font-bold"},pe={class:"ml-2 line-through"},ue=e("p",{class:"ml-2 hidden sm:block text-xl"},"已加入收藏",-1),he=e("p",{class:"ml-2 hidden sm:block text-xl"},"未加入收藏",-1),me={key:0,class:"flex flex-wrap items-center mt-8"},_e=e("h5",{class:"text-lg mr-4 mb-6"},"規格：",-1),ge={class:"flex flex-wrap text-sm"},xe=["id","value"],fe=["for"],be={key:1,class:"text-sm"},ye={class:"sm:flex items-center mt-4"},ve={class:"flex items-center"},we={class:"flex"},ke=["disabled"],Pe=["disabled"],Se=["disabled"],Ve={key:0,class:"animate-spin h-5 w-5 mr-3 text-white absolute",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Te=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),Le=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),Me=[Te,Le],Ce={key:0,class:"mt-8 bg-black/50 px-2 md:px-0"},Ie={class:"container py-8"},qe=e("h3",{class:"text-xl font-bold pb-3 border-b"},"加購配件",-1),je={class:"flex flex-wrap mt-4 px-2"},Ae={class:"bg-white"},Ne=["src"],Ue={class:"flex flex-col px-2 py-4 h-[calc(100%-192px)]"},He={class:"text-lg font-bold"},Re=["innerHTML"],Be={class:"flex-auto flex flex-col justify-end"},Ee={key:0,class:"text-sm mt-4"},Ge=["onUpdate:modelValue"],ze=e("option",{selected:"",disabled:"",value:"",class:"bg-white/10"}," 選擇規格 ",-1),Fe=["value"],De={key:1,class:"w-full"},Oe=["onUpdate:modelValue"],Xe=O('<option selected value="1" class="bg-white/10">1</option><option value="2" class="bg-white/10">2</option><option value="3" class="bg-white/10">3</option><option value="4" class="bg-white/10">4</option><option value="5" class="bg-white/10">5</option>',5),Je=[Xe],Ke={class:"flex justify-between items-end mt-4"},Qe={class:"text-xl font-bold text-primary"},We=["disabled","onClick"],Ye={key:0,class:"animate-spin h-3 w-3 mr-1 text-white absolute top-3 left-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ze=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),$e=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),es=[Ze,$e],ss={class:"container py-8"},ts=e("h3",{class:"text-xl font-bold pb-3 mb-4 border-b"},"商品詳細資訊",-1),os=["innerHTML"],rs=["src"],is={class:"container mt-8 px-2 md:px-0"},cs=e("h3",{class:"text-xl font-bold pb-3 mb-4 border-b"},"您可能也喜歡",-1),ls={class:"h-full"},ns=["src"],ds={class:"absolute top-4 left-4"},as={class:"bg-dark px-2 py-1 rounded-sm text-white text-xs mr-1"},ps={class:"p-3 md:p-5 h-1/2 flex flex-col justify-between rounded-b",style:{background:`linear-gradient(
                  142.88deg,
                  rgba(255, 255, 255, 0.16) 8.09%,
                  rgba(255, 255, 255, 0.064) 27.24%,
                  rgba(255, 255, 255, 0.064) 34.42%,
                  rgba(255, 255, 255, 0.1088) 48.78%,
                  rgba(255, 255, 255, 0) 100%
                )`}},us={class:"text-white"},hs={class:"text-left"},ms={class:"text-lg font-bold ellipse2 mb-2"},_s=["innerHTML"],gs={class:"flex flex-col justify-end"},xs={class:"whitespace-nowrap mb-2"},fs={class:"flex justify-between items-center"},bs={class:"text-gray-400 line-through text-xs"},ys={class:"text-md font-bold"},vs={class:"text-end"};function ws(r,o,a,ks,s,P){var V,T,L;const y=g("swiper-slide"),S=g("swiper"),v=g("font-awesome-icon"),N=g("RouterLink"),U=g("ScrollTop");return i(),c(u,null,[e("div",K,[e("div",Q,[e("div",null,[e("img",{src:s.targetImage,class:"h-[240px] sm:h-[360px] xl:h-[480px] object-contain mx-auto bg-white rounded",alt:""},null,8,W),p(S,{ref:"productSwiper",slidesPerView:3,slidesPerGroup:3,breakpoints:{480:{slidesPerView:4,slidesPerGroup:4},768:{slidesPerView:5,slidesPerGroup:5},976:{slidesPerView:4,slidesPerGroup:4},1440:{slidesPerView:5,slidesPerGroup:5}},spaceBetween:30,navigation:!0,modules:s.productModules,class:"productSwiper mt-6 !px-8 sm:!px-16 xl:!px-24"},{default:m(()=>[p(y,null,{default:m(()=>[e("div",{class:"cursor-pointer",onMouseover:o[0]||(o[0]=t=>P.changeImg(s.product.imageUrl))},[e("img",{class:"h-20 object-contain mx-auto bg-white border-2 hover:border-primary",src:s.product.imageUrl,alt:""},null,8,Y)],32)]),_:1}),(i(!0),c(u,null,_(s.product.imagesUrl,(t,l)=>(i(),I(y,{key:l},{default:m(()=>[e("div",{class:"cursor-pointer",onMouseover:d=>P.changeImg(t)},[e("img",{class:"h-20 object-contain mx-auto bg-white border-2 hover:border-primary",src:t,alt:""},null,8,$)],40,Z)]),_:2},1024))),128))]),_:1},8,["modules"])]),e("section",ee,[e("div",se,[e("h4",te,n(s.product.brand),1),e("div",oe,n(s.product.category),1)]),e("h3",re,n(s.product.title),1),e("div",ie,[e("div",{class:"prose prose-front prose-styles leading-relaxed",innerHTML:s.product.description},null,8,ce)]),e("div",le,[e("div",ne,[e("div",de,[e("p",ae," NT$ "+n(r.$filters.currency(s.product.price)),1),e("p",pe," NT$ "+n(r.$filters.currency(s.product.origin_price)),1)]),r.favorites.some(t=>t.id===s.product.id)?(i(),c("div",{key:0,class:"flex items-center cursor-pointer text-primary2",onClick:o[1]||(o[1]=t=>r.updateFavorite(s.product))},[p(v,{icon:["fas","heart"],class:"text-2xl"}),ue])):(i(),c("div",{key:1,class:"flex items-center cursor-pointer hover:text-primary",onClick:o[2]||(o[2]=t=>r.updateFavorite(s.product))},[p(v,{icon:["fas","heart"],class:"text-2xl"}),he]))]),s.product.spec?(i(),c("div",me,[_e,e("ul",ge,[(i(!0),c(u,null,_(s.product.spec,(t,l)=>(i(),c("li",{class:"mb-6",key:l},[x(e("input",{type:"radio",id:`spec${l}`,name:"spec",class:"hidden peer",value:t,"onUpdate:modelValue":o[3]||(o[3]=d=>s.cartSpec=d),required:""},null,8,xe),[[D,s.cartSpec]]),e("label",{for:`spec${l}`,class:"mr-3 bg-black hover:bg-primary2 peer-checked:bg-primary peer-checked:hover:bg-primary2 peer-checked:ring-1 peer-checked:ring-white px-3 py-2 rounded cursor-pointer"},n(t),9,fe)]))),128))])])):h("",!0),(V=s.product.spec)!=null&&V.length?(i(),c("p",be," ※ 選擇規格後才能加入購物車 ")):h("",!0),e("div",ye,[e("div",ve,[e("div",we,[e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-l text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:o[4]||(o[4]=t=>s.qty-=1),disabled:s.qty===1}," － ",8,ke),x(e("input",{type:"number",class:"w-12 bg-dark text-sm text-end focus:border-secondary",min:"1",max:"99","onUpdate:modelValue":o[5]||(o[5]=t=>s.qty=t)},null,512),[[F,s.qty,void 0,{lazy:!0}]]),e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-r text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:o[6]||(o[6]=t=>s.qty+=1),disabled:s.qty===99}," ＋ ",8,Pe)])]),e("button",{type:"button",class:"w-full primary-button sm:ml-2 mt-4 sm:mt-0 relative",disabled:r.cartLoading.cartId===s.product.id||((T=s.product.spec)!=null&&T.length?!s.cartSpec:!1),onClick:o[7]||(o[7]=t=>r.addCart(s.product,s.qty,s.cartSpec))},[r.cartLoading.cartId===s.product.id?(i(),c("svg",Ve,Me)):h("",!0),k(" 加入購物車 ")],8,Se)])])])]),s.product.accessory?(i(),c("section",Ce,[e("div",Ie,[qe,e("div",je,[(i(!0),c(u,null,_(s.accessories,(t,l)=>(i(),c("div",{class:"border rounded w-64 mt-6 mx-3",key:t.id},[e("div",Ae,[e("img",{src:t.imageUrl,alt:"",class:"w-full h-48 object-contain object-center bg-white"},null,8,Ne)]),e("div",Ue,[e("h4",He,n(t.title),1),e("div",{class:"mt-4 text-md",innerHTML:t.description},null,8,Re),e("div",Be,[t.spec?(i(),c("p",Ee,"※請先選擇規格")):h("",!0),e("div",{class:C(["flex items-center",[t.spec?" mt-2":" mt-6"]])},[t.spec?x((i(),c("select",{key:0,id:"accessorySpec1",class:"border text-sm rounded w-full p-2 bg-gray-600 border-gray-500 text-white focus:ring-primary focus:border-ring-primary","onUpdate:modelValue":d=>s.cart_specs[l].spec=d},[ze,(i(!0),c(u,null,_(t.spec,d=>(i(),c("option",{class:"bg-white/10",key:d,value:d},n(d),9,Fe))),128))],8,Ge)),[[q,s.cart_specs[l].spec]]):(i(),c("p",De,"選擇數量：")),x(e("select",{id:"accessoryNum1",class:"ml-1 border text-sm rounded p-2 bg-gray-600 border-gray-500 text-white focus:ring-primary focus:border-ring-primary w-24","onUpdate:modelValue":d=>s.cart_specs[l].qty=d},Je,8,Oe),[[q,s.cart_specs[l].qty,void 0,{number:!0}]])],2),e("div",Ke,[e("p",Qe," NT$ "+n(r.$filters.currency(t.price)),1),e("button",{type:"button",class:"w-20 px-0 py-2 primary-button sm:ml-2 mt-4 sm:mt-0 relative",disabled:r.cartLoading.cartId===s.cart_specs[l].id||t.spec&&!s.cart_specs[l].spec,onClick:d=>r.addCart(s.accessories[l],s.cart_specs[l].qty,s.cart_specs[l].spec)},[r.cartLoading.cartId===s.cart_specs[l].id?(i(),c("svg",Ye,es)):h("",!0),k(" 加購 ")],8,We)])])])]))),128))])])])):h("",!0),s.product.content||(L=s.product.contentImages)!=null&&L.length?(i(),c("section",{key:1,class:C(["bg-black/50 px-2 md:px-0",{"mt-8":!s.product.accessory}])},[e("div",ss,[ts,e("div",{class:"prose prose-front prose-styles leading-loose",innerHTML:s.product.content},null,8,os),(i(!0),c(u,null,_(s.product.contentImages,(t,l)=>(i(),c("img",{key:l,src:t,alt:"",class:"mt-4 rounded-lg max-w-4xl"},null,8,rs))),128))])],2)):h("",!0),e("section",is,[cs,p(S,{ref:"productSwiper",slidesPerView:1,slidesPerGroup:1,breakpoints:{768:{slidesPerView:2,slidesPerGroup:2},976:{slidesPerView:3,slidesPerGroup:3},1440:{slidesPerView:4,slidesPerGroup:4}},spaceBetween:30,navigation:!0,modules:s.productModules,class:"productSwiper mt-6 !px-8 sm:!px-16 xl:!px-24 h-[420px]"},{default:m(()=>[(i(!0),c(u,null,_(s.otherProducts,t=>(i(),I(y,{key:t.id},{default:m(()=>[e("div",ls,[e("img",{class:"h-1/2 w-full object-cover bg-white rounded-t relative",src:t.imageUrl,alt:""},null,8,ns),e("div",ds,[e("div",as,n(t.brand),1)]),e("div",ps,[e("div",us,[e("div",hs,[e("h5",ms,n(t.title),1),e("p",{class:"text-sm ellipse2 prose prose-front prose-styles leading-normal",innerHTML:t.description},null,8,_s)])]),e("div",gs,[e("div",xs,[e("div",fs,[e("p",bs," NT$ "+n(r.$filters.currency(t.origin_price)),1),e("p",ys," NT$ "+n(r.$filters.currency(t.price)),1)])]),e("div",vs,[p(N,{to:`/product/${t.id}`,class:"text-primary hover:underline"},{default:m(()=>[k(" 了解詳情 "),p(v,{icon:["fas","chevron-right"]})]),_:2},1032,["to"])])])])])]),_:2},1024))),128))]),_:1},8,["modules"])])]),p(U)],64)}const Ms=E(J,[["render",ws]]);export{Ms as default};
