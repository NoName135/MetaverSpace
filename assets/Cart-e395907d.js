import{M as z}from"./index-9908806f.js";import{f as w}from"./favoriteStore-438d10c8.js";import{c as C}from"./cartStore-16b2416f.js";import{m as k,a as g,_ as q,o as a,c as d,b as e,F as _,g as y,n as A,t as n,i as v,z as B,f as I,h as f,l as F,v as T,d as m,w as j,r as L,j as U}from"./index-29ad0527.js";import{s as S}from"./swal-3e866175.js";const E={mixins:[S],methods:{openModal(){this.favoriteModal.show()},moveToCart(t,o){this.cart.carts.some(u=>u.product_id===t.id)?this.userToast("warning","此商品已在購物車"):this.addCart(t,1,o)},...k(w,["getFavorite","updateFavorite"]),...k(C,["addCart"])},computed:{...g(w,["favorites","cart_specs"]),...g(C,["cartLoading","cart"])},mounted(){const t={placement:"top-center",backdrop:"dynamic",backdropClasses:"bg-black bg-opacity-80 fixed inset-0 z-40",closable:!0};this.favoriteModal=new z(this.$refs.favoriteModal,t)}},N={ref:"favoriteModal",id:"favoriteModal",tabindex:"-1","aria-hidden":"true",class:"fixed top-8 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto h-[calc(100%-1rem)] md:h-full max-h-[calc(100vh-3rem)]"},D={class:"w-full h-full max-w-2xl"},P={class:"rounded-lg overflow-hidden shadow bg-dark"},O={class:"flex items-start justify-between p-4 border rounded-t-lg border-gray-600 bg-black fixed top-5 w-[calc(100%-2rem)] md:w-full max-w-2xl z-50"},H=e("h3",{class:"text-lg md:text-xl font-semibold text-white"}," 請選擇商品加入購物車 ",-1),R=e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),G=[R],J={class:"px-4 pt-6"},K=["src"],Q={class:"col-span-full md:col-span-3 flex flex-col justify-between"},W={class:"flex justify-between items-center"},X={class:"text-lg lg:text-xl"},Y=["id","onUpdate:modelValue"],Z=e("option",{selected:"",disabled:"",value:"",class:"bg-dark/10"}," 選擇規格 ",-1),tt=["value"],et={class:"text-xl lg:text-2xl mt-4"},st={class:"xs:flex justify-between items-end mt-4 md:mt-0"},ot={class:"text-lg lg:text-xl"},at={class:"font-bold"},dt=["disabled","onClick"];function lt(t,o,u,$,M,p){return a(),d("div",N,[e("div",D,[e("div",P,[e("div",O,[H,e("button",{type:"button",class:"text-gray-400 bg-transparent rounded-lg text-sm p-1.5 ml-auto inline-flex items-center hover:bg-gray-600 hover:text-white",onClick:o[0]||(o[0]=l=>t.favoriteModal.hide())},G)]),e("div",J,[(a(!0),d(_,null,y(t.favorites,(l,i)=>(a(),d("div",{key:l.id,class:A(["py-8 grid grid-cols-4 gap-6",{"border-t":i>0}])},[e("img",{src:l.imageUrl,alt:"",class:"hidden md:flex self-center w-full h-28 object-cover rounded bg-white"},null,8,K),e("div",Q,[e("div",null,[e("div",W,[e("h2",X,n(l.brand),1),l.spec?v((a(),d("select",{key:0,id:`spec${i}`,class:"mt-4 sm:mt-0 border text-sm rounded p-2 bg-gray-600 border-gray-500 text-white focus:ring-primary","onUpdate:modelValue":h=>t.cart_specs[i]=h},[Z,(a(!0),d(_,null,y(l.spec,(h,x)=>(a(),d("option",{key:x,value:h,class:"bg-dark/10"},n(h),9,tt))),128))],8,Y)),[[B,t.cart_specs[i]]]):I("",!0)]),e("h3",et,n(l.title),1)]),e("div",null,[e("div",st,[e("h5",ot,[f(" 售價："),e("span",at,"NT$ "+n(t.$filters.currency(l.price)),1)]),e("button",{type:"button",class:"mt-5 sm:mt-0 primary-button sm:ml-3",disabled:l.spec&&!t.cart_specs[i]||t.cartLoading.cartId===l.id,onClick:h=>p.moveToCart(l,t.cart_specs[i])}," 加入購物車 ",8,dt)])])])],2))),128))])])])],512)}const rt=q(E,[["render",lt]]),{VITE_API:nt,VITE_PATH:ct}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"metaverspace",BASE_URL:"/MetaverSpace",MODE:"production",DEV:!1,PROD:!0,SSR:!1},it={mixins:[S],data(){return{coupon:""}},methods:{deleteAlert(t,o){let u="";o>=0&&(u=`(${t.cart_spec[o].title})`),this.$swal.fire({title:"刪除購物車商品",text:`確定要刪除 ${t.product.title} ${u}？`,icon:"warning",confirmButtonColor:"#FE5F50",confirmButtonText:"確定刪除",backdrop:" rgba(0,0,0,0.8)",showCancelButton:!0,cancelButtonColor:"#6b7280"}).then($=>{$.isConfirmed&&(o>=0?this.deleteCartSpec(t,o):this.deleteCart(t.id))})},async moveToFavorite(t,o){this.favorites.some(u=>u.id===o.id)?this.userToast("warning","商品已在收藏清單"):(await this.deleteCart(t),this.updateFavorite(o))},addCoupon(){this.$http.post(`${nt}/api/${ct}/coupon`,{data:{code:this.coupon}}).then(t=>{this.userToast("success",t.data.message),this.getCart()}).catch(t=>{this.userToast("error",t.response.data.message)})},...k(C,["getCart","updateCart","updateCartSpec","deleteCart","deleteCartSpec"]),...k(w,["updateFavorite"])},computed:{...g(F,["loadings"]),...g(C,["cart","cartLoading"]),...g(w,["favorites"])},mounted(){var t,o;this.favoriteModal=this.$refs.favoriteModal,(t=this.cart.carts)!=null&&t.length&&(this.coupon=((o=this.cart.carts[0].coupon)==null?void 0:o.code)||"")},components:{UserFavoriteModal:rt}},ut={class:"mt-nav"},pt={class:"container px-2 md:px-0 pt-8"},ht={class:"border-2 rounded-lg xl:mx-48 overflow-hidden"},bt={class:"flex justify-between items-center px-4 py-2.5 bg-black/50 border-b-2"},ft=e("h1",{class:"text-xl font-bold"},"我的購物車",-1),mt={class:"px-8 pb-4"},gt={key:0,class:"mt-10 text-center text-3xl"},_t={key:1},yt={class:"flex justify-between items-center"},xt=["disabled","onClick"],vt=e("span",null,"移動至收藏",-1),wt={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ct=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),kt=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),$t=[Ct,kt],Mt={class:"grid grid-cols-12 md:gap-6 mt-6"},Tt=["src"],Lt={class:"col-span-full md:col-span-9 flex flex-col justify-between"},It={class:"flex flex-wrap justify-between items-center"},Vt={class:"text-lg lg:text-xl mr-4"},jt={class:"text-xl lg:text-2xl mt-4 lg:mt-6 font-bold"},qt={class:"flex flex-col sm:flex-row justify-between"},St=["id","value","onChange","disabled"],zt=["value"],At={class:"flex mt-3 sm:mt-0 sm:ml-4"},Bt=e("span",{class:"sm:hidden flex items-center text-md lg:text-lg"},"數量：",-1),Ft=["onClick","disabled"],Ut=["onUpdate:modelValue","onChange","disabled"],Et=["onClick","disabled"],Nt=["onClick","disabled"],Dt={class:"flex flex-col sm:flex-row justify-between items-center"},Pt={key:0,class:"flex items-center self-start mt-6"},Ot=e("span",{class:"text-md lg:text-lg"},"數量：",-1),Ht={class:"flex sm:mt-0 sm:ml-4"},Rt=["onClick","disabled"],Gt=["onUpdate:modelValue","onChange","disabled"],Jt=["onClick","disabled"],Kt={key:1},Qt={class:"self-end text-lg lg:text-xl mt-6"},Wt={class:"font-bold"},Xt={class:"flex flex-col items-end py-6"},Yt={class:"mt-4 xs:mt-0 xs:ml-4 text-lg lg:text-xl text-end"},Zt={class:"font-bold whitespace-nowrap"},te={class:"mt-4 flex items-center"},ee={key:0,class:"mt-4 text-warm text-lg lg:text-xl"},se={class:"font-bold"},oe={class:"mt-4 text-primary0 text-xl lg:text-2xl text-end"},ae={class:"font-bold whitespace-nowrap"};function de(t,o,u,$,M,p){var x;const l=L("font-awesome-icon"),i=L("router-link"),h=L("user-favorite-modal");return a(),d("div",ut,[e("div",pt,[e("div",ht,[e("div",bt,[ft,e("button",{type:"button",class:"ml-2 dark-solid-button",onClick:o[0]||(o[0]=s=>t.favoriteModal.openModal())}," 收藏清單 ")]),e("div",mt,[(x=Object.keys(t.cart))!=null&&x.length?(a(),d("ul",_t,[(a(!0),d(_,null,y(t.cart.carts,s=>(a(),d("li",{class:"py-8 border-b",key:s.id},[e("div",yt,[e("button",{type:"button",class:"w-18 focus:outline-none focus:ring-4 font-medium rounded text-sm px-4 py-2.5 bg-primary hover:bg-primary2 focus:ring-primary3 disabled:bg-primary2 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:t.cartLoading.cartId===s.id,onClick:r=>p.moveToFavorite(s.id,s.product)},[m(l,{icon:["fas","heart"],class:"mr-2"}),vt],8,xt),t.cartLoading.cartId!==s.id?(a(),U(l,{key:0,icon:["fas","trash-can"],class:"text-xl lg:text-2xl hover:text-warm cursor-pointer",onClick:r=>p.deleteAlert(s)},null,8,["onClick"])):(a(),d("svg",wt,$t))]),e("div",Mt,[e("img",{src:s.product.imageUrl,alt:"",class:"col-span-3 hidden md:block w-full h-28 lg:h-32 xl:h-40 object-cover rounded bg-white"},null,8,Tt),e("div",Lt,[e("div",It,[e("h2",Vt,n(s.product.brand),1),m(i,{to:`/product/${s.product.id}`,target:"_blank",class:"mt-2 sm:mt-0 dark-solid-button py-2 relative whitespace-nowrap"},{default:j(()=>[f(" 查看商品 "),m(l,{icon:["fas","arrow-up-right-from-square"],class:"absolute top-1 right-1 text-sm lg:text-md"})]),_:2},1032,["to"])]),e("h3",jt,n(s.product.title),1),(a(!0),d(_,null,y(s.cart_spec,(r,b)=>{var V;return a(),d("div",{class:"flex justify-between sm:justify-start items-start sm:items-center mt-8",key:r.title},[e("div",qt,[e("select",{id:`spec${b}`,class:"border text-sm rounded p-2 bg-gray-600 border-gray-500 text-white focus:ring-primary focus:border-ring-primary",value:r.title,onChange:c=>t.updateCartSpec(s,c.target.value,b),disabled:t.cartLoading.cartId===s.id},[(a(!0),d(_,null,y(s.product.spec,c=>(a(),d("option",{class:"bg-dark/10",key:c,value:c},n(c),9,zt))),128))],40,St),e("div",At,[Bt,e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-l text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:()=>{r.qty-=1,t.updateCart(s,b)},disabled:r.qty===1||t.cartLoading.cartId===s.id}," － ",8,Ft),v(e("input",{type:"number",class:"w-12 bg-dark text-sm text-end focus:border-secondary disabled:text-gray-500",min:"1",max:"99","onUpdate:modelValue":c=>r.qty=c,onChange:c=>t.updateCart(s,b),disabled:t.cartLoading.cartId===s.id},null,40,Ut),[[T,r.qty,void 0,{lazy:!0}]]),e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-r text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:()=>{r.qty+=1,t.updateCart(s,b)},disabled:r.qty===99||t.cartLoading.cartId===s.id}," ＋ ",8,Et)])]),m(l,{icon:["fas","xmark"],size:"2xl",class:"sm:hidden hover:text-warm",onClick:c=>p.deleteAlert(s,b)},null,8,["onClick"]),((V=s.cart_spec)==null?void 0:V.length)>1?(a(),d("button",{key:0,type:"button",class:"hidden sm:block ml-8 w-18 focus:outline-none focus:ring-4 font-medium rounded text-sm px-5 py-2.5 bg-warm hover:bg-warm2 focus:ring-warm3 disabled:bg-warm2 disabled:text-gray-300 disabled:cursor-not-allowed",onClick:c=>p.deleteAlert(s,b),disabled:t.cartLoading.cartId===s.id}," 刪除 ",8,Nt)):I("",!0)])}),128)),e("div",Dt,[s.cart_spec?(a(),d("div",Kt)):(a(),d("div",Pt,[Ot,e("div",Ht,[e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-l text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:()=>{s.qty-=1,t.updateCart(s,t.i)},disabled:s.qty===1||t.cartLoading.cartId===s.id}," － ",8,Rt),v(e("input",{type:"number",class:"w-12 bg-dark text-sm text-end focus:border-secondary disabled:text-gray-500",min:"1",max:"99","onUpdate:modelValue":r=>s.qty=r,onChange:r=>t.updateCart(s,t.i),disabled:t.cartLoading.cartId===s.id},null,40,Gt),[[T,s.qty,void 0,{lazy:!0}]]),e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-r text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:()=>{s.qty+=1,t.updateCart(s,t.i)},disabled:s.qty===99||t.cartLoading.cartId===s.id}," ＋ ",8,Jt)])])),e("h5",Qt,[f(" 總計："),e("span",Wt,"NT$ "+n(t.$filters.currency(s.total)),1)])])])])]))),128))])):(a(),d("p",gt," 購物車沒有商品 ")),e("div",Xt,[e("h4",Yt,[f(" 結帳小計："),e("span",Zt,"NT$ "+n(t.$filters.currency(t.cart.total)),1)]),e("div",te,[v(e("input",{type:"text",placeholder:"請輸入優惠碼",class:"border text-sm rounded block w-28 sm:w-36 p-2 bg-gray-700 border-gray-600 placeholder-gray-400 focus:ring-secondary focus:border-secondary","onUpdate:modelValue":o[1]||(o[1]=s=>M.coupon=s)},null,512),[[T,M.coupon]]),e("button",{type:"button",class:"ml-2 w-18 focus:outline-none focus:ring-4 font-medium rounded text-sm px-5 py-2.5 bg-secondary hover:bg-secondary2 focus:ring-secondary3",onClick:o[2]||(o[2]=(...s)=>p.addCoupon&&p.addCoupon(...s))}," 套用 ")]),t.cart.total-t.cart.final_total>0?(a(),d("h5",ee,[f(" 折扣："),e("span",se,"NT$ "+n(t.$filters.currency(Math.ceil(t.cart.total-t.cart.final_total))),1)])):I("",!0),e("h3",oe,[f(" 總金額："),e("span",ae,"NT$ "+n(t.$filters.currency(t.cart.final_total)),1)]),m(i,{to:{name:"結帳"},class:"mt-8 primary-button"},{default:j(()=>[f("前往結帳")]),_:1})])])])]),m(h,{ref:"favoriteModal"},null,512)])}const ue=q(it,[["render",de]]);export{ue as default};
