import{M as B}from"./index-9908806f.js";import{f as C}from"./favoriteStore-c49c55e0.js";import{c as k}from"./cartStore-56b17caf.js";import{m as $,a as m,_ as S,o as a,c as d,b as e,F as _,g as y,n as F,t as c,i as v,y as U,f as w,h,l as z,d as g,w as L,v as I,j as q,r as V}from"./index-007e9175.js";import{s as A}from"./swal-e4da1902.js";const E={mixins:[A],methods:{openModal(){this.favoriteModal.show()},moveToCart(t,o){this.cart.carts.some(u=>u.product_id===t.id)?this.userToast("warning","此商品已在購物車"):this.addCart(t,1,o)},...$(C,["getFavorite","updateFavorite"]),...$(k,["addCart"])},computed:{...m(C,["favorites","cart_specs"]),...m(k,["cartLoading","cart"])},mounted(){const t={placement:"top-center",backdrop:"dynamic",backdropClasses:"bg-black bg-opacity-80 fixed inset-0 z-40",closable:!0};this.favoriteModal=new B(this.$refs.favoriteModal,t)}},N={ref:"favoriteModal",id:"favoriteModal",tabindex:"-1","aria-hidden":"true",class:"fixed top-8 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto h-[calc(100%-1rem)] md:h-full max-h-[calc(100vh-3rem)]"},D={class:"w-full h-full max-w-2xl"},P={class:"rounded-lg overflow-hidden shadow bg-dark"},R={class:"flex items-start justify-between p-4 border rounded-t-lg border-gray-600 bg-black fixed top-5 w-[calc(100%-2rem)] md:w-full max-w-2xl z-50"},O=e("h3",{class:"text-lg md:text-xl font-semibold text-white"}," 請選擇商品加入購物車 ",-1),H=e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),G=[H],J={class:"px-4 pt-6"},K=["src"],Q={class:"col-span-full md:col-span-3 flex flex-col justify-between"},W={class:"flex justify-between items-center"},X={class:"text-lg lg:text-xl"},Y=["id","onUpdate:modelValue"],Z=e("option",{selected:"",disabled:"",value:"",class:"bg-dark/10"}," 選擇規格 ",-1),tt=["value"],et={class:"text-xl lg:text-2xl mt-6"},st={class:"xs:flex justify-between items-center mt-6"},ot={class:"text-lg lg:text-xl"},at={class:"font-bold"},dt=["disabled","onClick"];function lt(t,o,u,M,T,p){return a(),d("div",N,[e("div",D,[e("div",P,[e("div",R,[O,e("button",{type:"button",class:"text-gray-400 bg-transparent rounded-lg text-sm p-1.5 ml-auto inline-flex items-center hover:bg-gray-600 hover:text-white",onClick:o[0]||(o[0]=l=>t.favoriteModal.hide())},G)]),e("div",J,[(a(!0),d(_,null,y(t.favorites,(l,n)=>(a(),d("div",{key:l.id,class:F(["py-8 grid grid-cols-4 gap-6",{"border-t":n>0}])},[e("img",{src:l.imageUrl,alt:"",class:"hidden md:flex self-center w-full h-28 object-cover rounded bg-white"},null,8,K),e("div",Q,[e("div",null,[e("div",W,[e("h2",X,c(l.brand),1),l.spec?v((a(),d("select",{key:0,id:`spec${n}`,class:"border text-sm rounded p-2 bg-gray-600 border-gray-500 text-white focus:ring-primary","onUpdate:modelValue":b=>t.cart_specs[n]=b},[Z,(a(!0),d(_,null,y(l.spec,(b,x)=>(a(),d("option",{key:x,value:b,class:"bg-dark/10"},c(b),9,tt))),128))],8,Y)),[[U,t.cart_specs[n]]]):w("",!0)]),e("h3",et,c(l.title),1)]),e("div",null,[e("div",st,[e("h5",ot,[h(" 售價："),e("span",at,"NT$ "+c(t.$filters.currency(l.price)),1)]),e("button",{type:"button",class:"mt-4 xs:mt-0 primary-button sm:ml-3",disabled:l.spec&&!t.cart_specs[n]||t.cartLoading.cartId===l.id,onClick:b=>p.moveToCart(l,t.cart_specs[n])}," 加入購物車 ",8,dt)])])])],2))),128))])])])],512)}const rt=S(E,[["render",lt]]),{VITE_API:nt,VITE_PATH:ct}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"metaverspace",BASE_URL:"/MetaverSpace",MODE:"production",DEV:!1,PROD:!0,SSR:!1},it={mixins:[A],data(){return{coupon:""}},methods:{deleteAlert(t,o){let u="";o>=0&&(u=`(${t.cart_spec[o].title})`),this.$swal.fire({title:"刪除購物車商品",text:`確定要刪除 ${t.product.title} ${u}？`,icon:"warning",confirmButtonColor:"#FE5F50",confirmButtonText:"確定刪除",backdrop:" rgba(0,0,0,0.8)",showCancelButton:!0,cancelButtonColor:"#6b7280"}).then(M=>{M.isConfirmed&&(o>=0?this.deleteCartSpec(t,o):this.deleteCart(t.id))})},async moveToFavorite(t,o){this.favorites.some(u=>u.id===o.id)?this.userToast("warning","商品已在收藏清單"):(await this.deleteCart(t),this.updateFavorite(o))},addCoupon(){this.$http.post(`${nt}/api/${ct}/coupon`,{data:{code:this.coupon}}).then(t=>{this.userToast("success",t.data.message),this.getCart()}).catch(t=>{this.userToast("error",t.response.data.message)})},...$(k,["getCart","updateCart","updateCartSpec","deleteCart","deleteCartSpec"]),...$(C,["updateFavorite"])},computed:{...m(z,["loadings"]),...m(k,["cart","cartLoading"]),...m(C,["favorites"])},mounted(){var t,o;this.favoriteModal=this.$refs.favoriteModal,(t=this.cart.carts)!=null&&t.length&&(this.coupon=((o=this.cart.carts[0].coupon)==null?void 0:o.code)||"")},components:{UserFavoriteModal:rt}},ut={class:"mt-nav"},pt={class:"container px-2 md:px-0 pt-8"},ht={class:"border-2 rounded-lg xl:mx-48 overflow-hidden"},bt={class:"flex justify-between items-center px-4 py-2.5 bg-black/50 border-b-2"},ft=e("h1",{class:"text-xl font-bold"},"我的購物車",-1),gt={class:"px-8 pb-4"},mt={key:0,class:"mt-10 border-b flex flex-col items-center pb-6"},_t=e("p",{class:"text-2xl md:text-3xl"},"購物車沒有商品",-1),yt={key:1},xt={class:"flex justify-between items-center"},vt=["disabled","onClick"],wt=e("span",null,"移動至收藏",-1),Ct={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},kt=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),$t=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),Mt=[kt,$t],Tt={class:"grid grid-cols-12 md:gap-6 mt-6"},Lt=["src"],It={class:"col-span-full md:col-span-9 flex flex-col justify-between"},Vt={class:"flex flex-wrap justify-between items-center"},jt={class:"text-lg lg:text-xl mr-4"},qt={class:"text-xl lg:text-2xl mt-4 lg:mt-6 font-bold"},St={class:"flex flex-col sm:flex-row justify-between"},At=["id","value","onChange","disabled"],Bt=["value"],Ft={class:"flex mt-3 sm:mt-0 sm:ml-4"},Ut=e("span",{class:"sm:hidden flex items-center text-md lg:text-lg"},"數量：",-1),zt=["onClick","disabled"],Et=["onUpdate:modelValue","onChange","disabled"],Nt=["onClick","disabled"],Dt=["onClick","disabled"],Pt={class:"flex flex-col sm:flex-row justify-between items-center"},Rt={key:0,class:"flex items-center self-start mt-6"},Ot=e("span",{class:"text-md lg:text-lg"},"數量：",-1),Ht={class:"flex sm:mt-0 sm:ml-4"},Gt=["onClick","disabled"],Jt=["onUpdate:modelValue","onChange","disabled"],Kt=["onClick","disabled"],Qt={key:1},Wt={class:"self-end text-lg lg:text-xl mt-6"},Xt={class:"font-bold"},Yt={class:"flex flex-col items-end py-6"},Zt={class:"mt-4 xs:mt-0 xs:ml-4 text-lg lg:text-xl text-end"},te={class:"font-bold whitespace-nowrap"},ee={class:"mt-4 flex items-center"},se={key:0,class:"mt-4 text-warm text-lg lg:text-xl"},oe={class:"font-bold"},ae={class:"mt-4 text-primary0 text-xl lg:text-2xl text-end"},de={class:"font-bold whitespace-nowrap"};function le(t,o,u,M,T,p){var x;const l=V("RouterLink"),n=V("font-awesome-icon"),b=V("user-favorite-modal");return a(),d("div",ut,[e("div",pt,[e("div",ht,[e("div",bt,[ft,e("button",{type:"button",class:"ml-2 dark-solid-button",onClick:o[0]||(o[0]=s=>t.favoriteModal.openModal())}," 收藏清單 ")]),e("div",gt,[(x=Object.keys(t.cart.carts))!=null&&x.length?(a(),d("ul",yt,[(a(!0),d(_,null,y(t.cart.carts,s=>(a(),d("li",{class:"py-8 border-b",key:s.id},[e("div",xt,[e("button",{type:"button",class:"w-18 focus:outline-none focus:ring-4 font-medium rounded text-sm px-4 py-2.5 bg-primary hover:bg-primary2 focus:ring-primary3 disabled:bg-primary2 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:t.cartLoading.cartId===s.id,onClick:r=>p.moveToFavorite(s.id,s.product)},[g(n,{icon:["fas","heart"],class:"mr-2"}),wt],8,vt),t.cartLoading.cartId!==s.id?(a(),q(n,{key:0,icon:["fas","trash-can"],class:"text-xl lg:text-2xl hover:text-warm cursor-pointer",onClick:r=>p.deleteAlert(s)},null,8,["onClick"])):(a(),d("svg",Ct,Mt))]),e("div",Tt,[e("img",{src:s.product.imageUrl,alt:"",class:"col-span-3 hidden md:block w-full h-28 lg:h-32 xl:h-40 object-cover rounded bg-white"},null,8,Lt),e("div",It,[e("div",Vt,[e("h2",jt,c(s.product.brand),1),g(l,{to:`/product/${s.product.id}`,class:"mt-2 sm:mt-0 dark-solid-button py-2 relative whitespace-nowrap"},{default:L(()=>[h(" 查看商品 "),g(n,{icon:["fas","arrow-up-right-from-square"],class:"absolute top-1 right-1 text-sm lg:text-md"})]),_:2},1032,["to"])]),e("h3",qt,c(s.product.title),1),(a(!0),d(_,null,y(s.cart_spec,(r,f)=>{var j;return a(),d("div",{class:"flex justify-between sm:justify-start items-start sm:items-center mt-8",key:r.title},[e("div",St,[e("select",{id:`spec${f}`,class:"border text-sm rounded p-2 bg-gray-600 border-gray-500 text-white focus:ring-primary focus:border-ring-primary",value:r.title,onChange:i=>t.updateCartSpec(s,i.target.value,f),disabled:t.cartLoading.cartId===s.id},[(a(!0),d(_,null,y(s.product.spec,i=>(a(),d("option",{class:"bg-dark/10",key:i,value:i},c(i),9,Bt))),128))],40,At),e("div",Ft,[Ut,e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-l text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:()=>{r.qty-=1,t.updateCart(s,f)},disabled:r.qty===1||t.cartLoading.cartId===s.id}," － ",8,zt),v(e("input",{type:"number",class:"w-12 bg-dark text-sm text-end focus:border-secondary disabled:text-gray-500",min:"1",max:"99","onUpdate:modelValue":i=>r.qty=i,onChange:i=>t.updateCart(s,f),disabled:t.cartLoading.cartId===s.id},null,40,Et),[[I,r.qty,void 0,{lazy:!0}]]),e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-r text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:()=>{r.qty+=1,t.updateCart(s,f)},disabled:r.qty===99||t.cartLoading.cartId===s.id}," ＋ ",8,Nt)])]),g(n,{icon:["fas","xmark"],size:"2xl",class:"sm:hidden hover:text-warm",onClick:i=>p.deleteAlert(s,f)},null,8,["onClick"]),((j=s.cart_spec)==null?void 0:j.length)>1?(a(),d("button",{key:0,type:"button",class:"hidden sm:block ml-8 w-18 focus:outline-none focus:ring-4 font-medium rounded text-sm px-5 py-2.5 bg-warm hover:bg-warm2 focus:ring-warm3 disabled:bg-warm2 disabled:text-gray-300 disabled:cursor-not-allowed",onClick:i=>p.deleteAlert(s,f),disabled:t.cartLoading.cartId===s.id}," 刪除 ",8,Dt)):w("",!0)])}),128)),e("div",Pt,[s.cart_spec?(a(),d("div",Qt)):(a(),d("div",Rt,[Ot,e("div",Ht,[e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-l text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:()=>{s.qty-=1,t.updateCart(s,t.i)},disabled:s.qty===1||t.cartLoading.cartId===s.id}," － ",8,Gt),v(e("input",{type:"number",class:"w-12 bg-dark text-sm text-end focus:border-secondary disabled:text-gray-500",min:"1",max:"99","onUpdate:modelValue":r=>s.qty=r,onChange:r=>t.updateCart(s,t.i),disabled:t.cartLoading.cartId===s.id},null,40,Jt),[[I,s.qty,void 0,{lazy:!0}]]),e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-r text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:()=>{s.qty+=1,t.updateCart(s,t.i)},disabled:s.qty===99||t.cartLoading.cartId===s.id}," ＋ ",8,Kt)])])),e("h5",Wt,[h(" 總計："),e("span",Xt,"NT$ "+c(t.$filters.currency(s.total)),1)])])])])]))),128))])):(a(),d("div",mt,[_t,g(l,{to:"./products",class:"primary-button mt-4"},{default:L(()=>[h("前往商店")]),_:1})])),e("div",Yt,[e("h4",Zt,[h(" 結帳小計："),e("span",te,"NT$ "+c(t.$filters.currency(t.cart.total)),1)]),e("div",ee,[v(e("input",{type:"text",placeholder:"請輸入優惠碼",class:"border text-sm rounded block w-28 sm:w-36 p-2 bg-gray-700 border-gray-600 placeholder-gray-400 focus:ring-secondary focus:border-secondary","onUpdate:modelValue":o[1]||(o[1]=s=>T.coupon=s)},null,512),[[I,T.coupon]]),e("button",{type:"button",class:"ml-2 w-18 focus:outline-none focus:ring-4 font-medium rounded text-sm px-5 py-2.5 bg-secondary hover:bg-secondary2 focus:ring-secondary3",onClick:o[2]||(o[2]=(...s)=>p.addCoupon&&p.addCoupon(...s))}," 套用 ")]),t.cart.total-t.cart.final_total>0?(a(),d("h5",se,[h(" 折扣："),e("span",oe,"NT$ "+c(t.$filters.currency(Math.ceil(t.cart.total-t.cart.final_total))),1)])):w("",!0),e("h3",ae,[h(" 總金額："),e("span",de,"NT$ "+c(t.$filters.currency(t.cart.final_total)),1)]),t.cart.total?(a(),q(l,{key:1,to:{name:"結帳"},class:"mt-8 primary-button"},{default:L(()=>[h("前往結帳")]),_:1})):w("",!0)])])])]),g(b,{ref:"favoriteModal"},null,512)])}const pe=S(it,[["render",le]]);export{pe as default};
