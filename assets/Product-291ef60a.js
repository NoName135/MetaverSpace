import{N as A,S as U,a as N}from"./navigation.min-f077672f.js";import{_ as j,m as S,a as x,l as H,x as B,c as i,b as e,d as m,w as f,t as d,F as u,g as h,f as a,i as _,v as E,h as V,r as g,o as r,j as z,s as F,n as D,y as C,z as R}from"./index-f82e1748.js";import{c as T}from"./cartStore-cf3b1d35.js";import{f as I}from"./favoriteStore-81e36a46.js";import{s as O}from"./swal-e4da1902.js";const{VITE_API:L,VITE_PATH:M}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"metaverspace",BASE_URL:"/MetaverSpace",MODE:"production",DEV:!1,PROD:!0,SSR:!1},G={mixins:[O],data(){return{product:{},accessories:[],cartSpec:"",qty:1,cart_specs:[],productModules:[A],targetImage:""}},methods:{getProduct(c){this.loadings.fullLoading=!0,this.$http.get(`${L}/api/${M}/product/${c}`).then(o=>{this.product=o.data.product,this.targetImage=this.product.imageUrl,this.product.accessory?this.getAccessory():this.loadings.fullLoading=!1}).catch(o=>{this.loadings.fullLoading=!1,this.userToast("error",o.response.data.message)})},async getAccessory(){const c=this.product.accessory.map(o=>this.$http.get(`${L}/api/${M}/product/${o.id}`));try{const o=await Promise.allSettled(c);this.accessories=o.filter(p=>p.status==="fulfilled").map(p=>p.value.data.product),this.cart_specs=this.accessories.map(p=>({id:p.id,spec:"",qty:1,check:!1})),this.loadings.fullLoading=!1}catch(o){this.loadings.fullLoading=!1,this.userToast("error",o.response.data.message)}this.loadings.fullLoading=!1},changeImg(c){this.targetImage=c},...S(T,["getCart","addCart"]),...S(I,["updateFavorite"])},computed:{...x(H,["loadings"]),...x(T,["cart","cartLoading"]),...x(I,["favorites"])},watch:{qty(){this.qty<1&&(this.qty=1),this.qty>99&&(this.qty=99)}},mounted(){this.getProduct(this.$route.params.id)},components:{Swiper:U,SwiperSlide:N,FontAwesomeIcon:B}},J={class:"mt-nav"},K={class:"container grid grid-cols-1 lg:grid-cols-2 gap-7 pt-8 px-2 md:px-0"},Q=["src"],W=["src"],X=["onMouseover"],Y=["src"],Z={class:"flex flex-col"},$={class:"flex items-center"},ee={class:"col-span-2 text-2xl mr-3"},te={class:"bg-white/30 px-3.5 py-2 rounded text-sm"},se={class:"mt-2 text-3xl font-bold"},oe={class:"mt-3 text-md"},re=["innerHTML"],ie={class:"flex-auto flex flex-col justify-end"},ce={class:"flex justify-between items-center mt-6"},le={class:"flex items-end"},ne={class:"text-primary text-2xl font-bold"},de={class:"ml-2 line-through"},ae=e("p",{class:"ml-2 hidden sm:block text-xl"},"已加入收藏",-1),pe=e("p",{class:"ml-2 hidden sm:block text-xl"},"未加入收藏",-1),ue={key:0,class:"flex flex-wrap items-center mt-8"},me=e("h5",{class:"text-lg mr-4 mb-6"},"規格：",-1),he={class:"flex flex-wrap text-sm"},_e=["id","value"],ge=["for"],xe={key:1,class:"text-sm"},fe={class:"sm:flex items-center mt-4"},be={class:"flex items-center"},ye={class:"flex"},ve=["disabled"],we=["disabled"],ke=["disabled"],Se={key:0,class:"animate-spin h-5 w-5 mr-3 text-white absolute",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ve=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),Ce=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),Te=[Ve,Ce],Ie={key:0,class:"mt-8 bg-black/50 px-2 md:px-0"},Le={class:"container py-8"},Me=e("h3",{class:"text-xl font-bold pb-3 border-b"},"加購配件",-1),qe={class:"flex flex-wrap mt-4 px-2"},Pe={class:"bg-white"},Ae=["src"],Ue={class:"flex flex-col px-2 py-4 h-[calc(100%-192px)]"},Ne={class:"text-lg font-bold"},je=["innerHTML"],He={class:"flex-auto flex flex-col justify-end"},Be={key:0,class:"text-sm mt-4"},Ee=["onUpdate:modelValue"],ze=e("option",{selected:"",disabled:"",value:"",class:"bg-white/10"}," 選擇規格 ",-1),Fe=["value"],De={key:1,class:"w-full"},Re=["onUpdate:modelValue"],Oe=R('<option selected value="1" class="bg-white/10">1</option><option value="2" class="bg-white/10">2</option><option value="3" class="bg-white/10">3</option><option value="4" class="bg-white/10">4</option><option value="5" class="bg-white/10">5</option>',5),Ge=[Oe],Je={class:"flex justify-between items-end mt-4"},Ke={class:"text-xl font-bold text-primary"},Qe=["disabled","onClick"],We={key:0,class:"animate-spin h-3 w-3 mr-1 text-white absolute top-3 left-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Xe=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),Ye=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),Ze=[Xe,Ye],$e={key:1,class:"px-2 md:px-0"},et={class:"container py-8"},tt=e("h3",{class:"text-xl font-bold pb-3 border-b"},"商品詳細資訊",-1),st=["innerHTML"],ot=["src"];function rt(c,o,p,it,t,b){var w,k;const y=g("swiper-slide"),q=g("swiper"),v=g("font-awesome-icon"),P=g("ScrollTop");return r(),i(u,null,[e("div",J,[e("div",K,[e("div",null,[e("img",{src:t.targetImage,class:"h-[240px] sm:h-[360px] xl:h-[480px] object-contain mx-auto bg-white rounded",alt:""},null,8,Q),m(q,{ref:"productSwiper",slidesPerView:3,breakpoints:{480:{slidesPerView:4},768:{slidesPerView:5},976:{slidesPerView:4},1440:{slidesPerView:5}},spaceBetween:30,loop:!0,navigation:!0,modules:t.productModules,class:"productSwiper mt-6 !px-8 sm:!px-16 xl:!px-24"},{default:f(()=>[m(y,null,{default:f(()=>[e("div",{class:"cursor-pointer",onMouseover:o[0]||(o[0]=s=>b.changeImg(t.product.imageUrl))},[e("img",{class:"h-20 object-contain mx-auto bg-white border-2 hover:border-primary",src:t.product.imageUrl,alt:""},null,8,W)],32)]),_:1}),(r(!0),i(u,null,h(t.product.imagesUrl,(s,l)=>(r(),z(y,{key:l},{default:f(()=>[e("div",{class:"cursor-pointer",onMouseover:n=>b.changeImg(s)},[e("img",{class:"h-20 object-contain mx-auto bg-white border-2 hover:border-primary",src:s,alt:""},null,8,Y)],40,X)]),_:2},1024))),128))]),_:1},8,["modules"])]),e("section",Z,[e("div",$,[e("h4",ee,d(t.product.brand),1),e("div",te,d(t.product.category),1)]),e("h3",se,d(t.product.title),1),e("div",oe,[e("div",{class:"leading-relaxed",innerHTML:t.product.description},null,8,re)]),e("div",ie,[e("div",ce,[e("div",le,[e("p",ne," NT$ "+d(c.$filters.currency(t.product.price)),1),e("p",de," NT$ "+d(c.$filters.currency(t.product.origin_price)),1)]),c.favorites.some(s=>s.id===t.product.id)?(r(),i("div",{key:0,class:"flex items-center cursor-pointer text-primary2",onClick:o[1]||(o[1]=s=>c.updateFavorite(t.product))},[m(v,{icon:["fas","heart"],class:"text-2xl"}),ae])):(r(),i("div",{key:1,class:"flex items-center cursor-pointer hover:text-primary",onClick:o[2]||(o[2]=s=>c.updateFavorite(t.product))},[m(v,{icon:["fas","heart"],class:"text-2xl"}),pe]))]),t.product.spec?(r(),i("div",ue,[me,e("ul",he,[(r(!0),i(u,null,h(t.product.spec,(s,l)=>(r(),i("li",{class:"mb-6",key:l},[_(e("input",{type:"radio",id:`spec${l}`,name:"spec",class:"hidden peer",value:s,"onUpdate:modelValue":o[3]||(o[3]=n=>t.cartSpec=n),required:""},null,8,_e),[[F,t.cartSpec]]),e("label",{for:`spec${l}`,class:"mr-3 bg-black hover:bg-primary2 peer-checked:bg-primary peer-checked:hover:bg-primary2 peer-checked:ring-1 peer-checked:ring-white px-3 py-2 rounded cursor-pointer"},d(s),9,ge)]))),128))])])):a("",!0),(w=t.product.spec)!=null&&w.length?(r(),i("p",xe," ※ 選擇規格後才能加入購物車 ")):a("",!0),e("div",fe,[e("div",be,[e("div",ye,[e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-l text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:o[4]||(o[4]=s=>t.qty-=1),disabled:t.qty===1}," － ",8,ve),_(e("input",{type:"number",class:"w-12 bg-dark text-sm text-end focus:border-secondary",min:"1",max:"99","onUpdate:modelValue":o[5]||(o[5]=s=>t.qty=s)},null,512),[[E,t.qty,void 0,{lazy:!0}]]),e("button",{type:"button",class:"bg-secondary hover:bg-secondary2 px-2 rounded-r text-sm disabled:bg-secondary2 disabled:text-gray-400 disabled:cursor-not-allowed",onClick:o[6]||(o[6]=s=>t.qty+=1),disabled:t.qty===99}," ＋ ",8,we)])]),e("button",{type:"button",class:"w-full primary-button sm:ml-2 mt-4 sm:mt-0 relative",disabled:c.cartLoading.cartId===t.product.id||((k=t.product.spec)!=null&&k.length?!t.cartSpec:!1),onClick:o[7]||(o[7]=s=>c.addCart(t.product,t.qty,t.cartSpec))},[c.cartLoading.cartId===t.product.id?(r(),i("svg",Se,Te)):a("",!0),V(" 加入購物車 ")],8,ke)])])])]),t.product.accessory?(r(),i("div",Ie,[e("div",Le,[Me,e("div",qe,[(r(!0),i(u,null,h(t.accessories,(s,l)=>(r(),i("div",{class:"border rounded w-64 mt-6 mx-3",key:s.id},[e("div",Pe,[e("img",{src:s.imageUrl,alt:"",class:"w-full h-48 object-contain object-center bg-white"},null,8,Ae)]),e("div",Ue,[e("h4",Ne,d(s.title),1),e("p",{class:"mt-4 text-md",innerHTML:s.description},null,8,je),e("div",He,[s.spec?(r(),i("p",Be,"※請先選擇規格")):a("",!0),e("div",{class:D(["flex items-center",[s.spec?" mt-2":" mt-6"]])},[s.spec?_((r(),i("select",{key:0,id:"accessorySpec1",class:"border text-sm rounded w-full p-2 bg-gray-600 border-gray-500 text-white focus:ring-primary focus:border-ring-primary","onUpdate:modelValue":n=>t.cart_specs[l].spec=n},[ze,(r(!0),i(u,null,h(s.spec,n=>(r(),i("option",{class:"bg-white/10",key:n,value:n},d(n),9,Fe))),128))],8,Ee)),[[C,t.cart_specs[l].spec]]):(r(),i("p",De,"選擇數量：")),_(e("select",{id:"accessoryNum1",class:"ml-1 border text-sm rounded p-2 bg-gray-600 border-gray-500 text-white focus:ring-primary focus:border-ring-primary w-24","onUpdate:modelValue":n=>t.cart_specs[l].qty=n},Ge,8,Re),[[C,t.cart_specs[l].qty,void 0,{number:!0}]])],2),e("div",Je,[e("p",Ke," NT$ "+d(c.$filters.currency(s.price)),1),e("button",{type:"button",class:"w-20 px-0 py-2 primary-button sm:ml-2 mt-4 sm:mt-0 relative",disabled:c.cartLoading.cartId===t.cart_specs[l].id||s.spec&&!t.cart_specs[l].spec,onClick:n=>c.addCart(t.accessories[l],t.cart_specs[l].qty,t.cart_specs[l].spec)},[c.cartLoading.cartId===t.cart_specs[l].id?(r(),i("svg",We,Ze)):a("",!0),V(" 加購 ")],8,Qe)])])])]))),128))])])])):a("",!0),t.product.content?(r(),i("div",$e,[e("div",et,[tt,e("p",{class:"mt-4 leading-loose",innerHTML:t.product.content},null,8,st),(r(!0),i(u,null,h(t.product.contentImages,(s,l)=>(r(),i("img",{key:l,src:s,alt:"",class:"mt-4"},null,8,ot))),128))])])):a("",!0)]),m(P)],64)}const pt=j(G,[["render",rt]]);export{pt as default};
