import{K as o,L as i}from"./index-bcb3825a.js";import{S as a}from"./cartStore-581299b9.js";const{VITE_API:c,VITE_PATH:p}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"metaverspace",VITE_RENDER_API:"https://metarverspace-server.onrender.com",BASE_URL:"/MetaverSpace/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},u=o("favorite",{state:()=>({favorites:[],favLoading:{},cart_specs:[]}),actions:{userToast(r,t){a.fire({icon:r,title:t,toast:!0,position:"top-end",background:"#080909",color:"#FFF",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",a.stopTimer),e.addEventListener("mouseleave",a.resumeTimer)},customClass:{timerProgressBar:"progress-bar",popup:"swal2-top"}})},async getFavorite(){const t=(JSON.parse(localStorage.getItem("favorites"))||[]).map(e=>i.get(`${c}/api/${p}/product/${e}`));try{const e=await Promise.allSettled(t);this.favorites=e.filter(s=>s.status==="fulfilled").map(s=>s.value.data.product),e.some(s=>s.status==="rejected")&&localStorage.setItem("favorites",JSON.stringify(this.favorites.map(s=>s.id))),this.cart_specs=[],this.favorites.forEach(()=>{this.cart_specs.push("")})}catch(e){this.userToast("error",e.response.data.message)}},updateFavorite(r){const t=this.favorites.findIndex(e=>e.id===r.id);t<0?(this.favorites.push(r),localStorage.setItem("favorites",JSON.stringify(this.favorites.map(e=>e.id))),this.userToast("success","已將商品加入收藏"),this.cart_specs.push("")):(this.favorites.splice(t,1),localStorage.setItem("favorites",JSON.stringify(this.favorites.map(e=>e.id))),this.userToast("success","已將商品移除收藏"),this.cart_specs.splice(t,1))}},getters:{}});export{u as f};
