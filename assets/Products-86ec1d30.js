import{P as O,D as z}from"./DeleteModal-5220691f.js";import{C as R,U as N}from"./ckeditor-c7a380a5.js";import{M as H}from"./index-9908806f.js";import{a as E,l as j,_ as S,r as b,o as r,c as n,b as t,i as m,v as _,d,w,f as h,F as P,g as M,y as q,u as I,h as g,z as F,n as X,t as x}from"./index-007e9175.js";import{s as D}from"./swal-e4da1902.js";const{VITE_API:A,VITE_PATH:B}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"metaverspace",BASE_URL:"/MetaverSpace",MODE:"production",DEV:!1,PROD:!0,SSR:!1},G={props:["page","accessories"],mixins:[D],data(){return{isNew:!0,tempProduct:{},isNewAccessory:!1,accessoryPlaceholder:"",accessoryDisable:!1,accessoryOptions:[],editor:R,editorConfig:{toolbar:["heading","bold","italic","|","undo","redo","|","numberedList","bulletedList","|","link"]},detailConfig:{toolbar:["heading","bold","italic","|","undo","redo","|","numberedList","bulletedList","outdent","indent","|","link","insertTable"]}}},methods:{openModal(o,s){o==="new"?(this.isNew=!0,this.tempProduct={imagesUrl:[],category:"",unit:"件",spec:[],accessory:[],contentImages:[],is_enabled:0},this.productModal.show()):(this.isNewAccessory=!0,this.isNew=!1,this.tempProduct={...s},this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.spec||(this.tempProduct.spec=[]),this.tempProduct.accessory||(this.tempProduct.accessory=[]),this.tempProduct.contentImages||(this.tempProduct.contentImages=[]),this.productModal.show()),this.$refs.productModal.scrollTop=0,this.changeAccessory()},updateProduct(){let o="post",s=`${A}/api/${B}/admin/product`;this.isNew||(o="put",s=`${A}/api/${B}/admin/product/${this.tempProduct.id}`),this.loadings.fullLoading=!0,this.$http[o](s,{data:this.tempProduct}).then(()=>{this.$emit("updateProducts",this.page,"update"),this.productModal.hide(),this.tempProduct.brand=""}).catch(a=>{this.adminToast("error",a.response.data.message)})},changeImage(o,s,a){s==="imageUrl"?this.tempProduct[s]=a:s==="imagesUrl"?this.tempProduct[s][o]=a:this.tempProduct[s][o]=a,s!=="imageUrl"&&this.$refs.productModal.scrollTo({top:this.$refs.productModal.scrollHeight})},changeAccessory(){this.accessoryOptions=[],this.accessories.forEach(o=>{var s;o.brand.toLowerCase()===((s=this.tempProduct.brand)==null?void 0:s.toLowerCase())&&this.accessoryOptions.push({id:o.id,name:o.title})})}},computed:{...E(j,["loadings"])},watch:{"tempProduct.brand"(){this.tempProduct.accessory.forEach((o,s)=>{this.accessories.some(a=>a.id===o.id)||(this.tempProduct.accessory.splice(s,1),this.accessories.length>0&&this.adminAlert("warning","請更新商品","已刪除不存在的配件，請記得點擊確認更新商品資訊！"))}),this.isNewAccessory||(this.tempProduct.accessory=[]),this.isNewAccessory=!1},tempProduct:{handler(){!this.tempProduct.brand||!this.tempProduct.category?(this.accessoryPlaceholder="請先輸入品牌及類別",this.accessoryDisable=!0):(this.accessoryPlaceholder="關鍵字搜尋",this.accessoryDisable=!1),this.tempProduct.origin_price<1&&(this.tempProduct.origin_price=null),this.tempProduct.price>this.tempProduct.origin_price&&(this.tempProduct.price=this.tempProduct.origin_price)},deep:!0}},mounted(){const o={placement:"center",backdrop:"static",backdropClasses:"bg-black bg-opacity-80 fixed inset-0 z-30",closable:!0};this.productModal=new H(this.$refs.productModal,o)},components:{UploadImg:N}},J={ref:"productModal",id:"productModal",tabindex:"-1",class:"hidden fixed z-40 w-full px-4 overflow-x-hidden overflow-y-auto top-28 left-0 right-0 h-auto"},K={class:"w-full max-w-7xl h-full max-h-[calc(100vh-8.5rem)]"},Q={class:"bg-white shadow rounded-lg overflow-hidden"},W={class:"flex items-start justify-between p-4 border-b bg-black top-[6rem] w-[calc(100%-2rem)] lg:w-[calc(100%-3rem)] max-w-7xl z-50 rounded-t-lg fixed"},Y=t("h3",{class:"text-xl font-semibold text-gray-300"},"編輯商品",-1),Z=t("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),$=[Z],ee={class:"p-6 grid grid-cols-3 gap-6 mt-12"},te={class:"col-span-1"},se=t("label",{for:"mainImgLink",class:"font-medium"},[g("主要圖片 (輸入網址或上傳圖片)"),t("span",{class:"font-bold text-rose-500"},"*")],-1),oe={class:"relative mt-4"},re=t("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 text-gray-500"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418"})])],-1),ne=t("span",null,null,-1),le=t("span",null,null,-1),ie=["src"],ce={class:"mt-8 space-y-4"},de=t("h3",{class:"font-medium"},"多圖新增 (輸入網址或上傳圖片)",-1),ae={class:"relative mt-4"},ue=t("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 text-gray-500"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418"})])],-1),pe=["onUpdate:modelValue"],me=t("span",null,null,-1),he=t("span",null,null,-1),ge=["src"],fe=["onClick"],_e={class:"col-span-2 space-y-6"},be=t("label",{for:"name",class:"block mb-2 font-medium"},[g("商品名稱"),t("span",{class:"font-bold text-rose-500"},"*")],-1),ye={class:"grid grid-cols-2 gap-4"},we=t("label",{for:"modalDistrict",class:"block mb-2 text-md font-medium text-gray-900"},[g("類別"),t("span",{class:"font-bold text-rose-500"},"*")],-1),Pe=F('<option value="" selected disabled>請選擇商品類別</option><option value="AR">AR (擴增實境)</option><option value="VR">VR (虛擬實境)</option><option value="MR">MR (混合實境)</option><option value="XR">XR (延展實境)</option><option value="配件">商品配件</option>',6),xe=[Pe],ve=t("label",{for:"brand",class:"block mb-2 font-medium"},[g("品牌"),t("span",{class:"font-bold text-rose-500"},"*")],-1),ke={class:"grid grid-cols-2 gap-4"},Me=t("label",{for:"origin_price",class:"block mb-2 font-medium"},[g("原價"),t("span",{class:"font-bold text-rose-500"},"*")],-1),Ce=t("label",{for:"price",class:"block mb-2 font-medium"},[g("售價 (請先輸入原價)"),t("span",{class:"font-bold text-rose-500"},"*")],-1),Ue=t("label",{for:"spec",class:"font-medium"},"商品規格",-1),Ie={class:"grid grid-cols-6 gap-1 mt-2"},Ve={class:"border rounded"},Ae=["onUpdate:modelValue"],Be=["onClick"],Le={key:0},Te={key:0},Ee=t("label",{class:"typo__label"},"選擇配件",-1),je=t("h3",{for:"message",class:"mb-2 font-medium text-gray-900"}," 商品功能簡介 ",-1),Se=t("h3",{for:"message",class:"mb-2 font-medium text-gray-900"}," 商品詳細內容 ",-1),De={class:"mt-8 space-y-4"},Oe=t("h3",{class:"font-medium"},"商品詳細內容圖庫",-1),ze={class:"grid grid-cols-4 gap-3"},Re={class:"relative"},Ne=t("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 text-gray-500"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418"})])],-1),He=["onUpdate:modelValue"],qe=t("span",null,null,-1),Fe=t("span",null,null,-1),Xe=["src"],Ge=["onClick"],Je={class:"pt-4 flex justify-between items-center border-t-2 border-gray-300"},Ke={class:"flex"},Qe={class:"relative inline-flex items-center cursor-pointer"},We=["checked"],Ye=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-teal-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-teal-600"},null,-1),Ze=t("span",{class:"ml-3 text-md font-medium text-gray-900"},"上架商品",-1),$e={class:"flex justify-end"},et=["disabled","title"];function tt(o,s,a,v,e,p){var l,y,V;const u=b("UploadImg"),C=b("font-awesome-icon"),U=b("multiselect"),k=b("ckeditor");return r(),n("div",J,[t("div",K,[t("div",Q,[t("div",W,[Y,t("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-600 hover:text-white rounded-lg text-sm p-1.5 ml-auto inline-flex items-center",onClick:s[0]||(s[0]=()=>{o.productModal.hide(),e.tempProduct.brand=""})},$)]),t("div",ee,[t("div",te,[se,t("div",oe,[re,m(t("input",{type:"text",id:"mainImgLink",class:"block w-full p-3 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-teal-500 focus:border-teal-500",placeholder:"請輸入圖片網址",required:"","onUpdate:modelValue":s[1]||(s[1]=i=>e.tempProduct.imageUrl=i)},null,512),[[_,e.tempProduct.imageUrl,void 0,{lazy:!0}]])]),d(u,{onChangeImg:p.changeImage},{multi:w(()=>[ne]),detail:w(()=>[le]),_:1},8,["onChangeImg"]),e.tempProduct.imageUrl?(r(),n("img",{key:0,src:e.tempProduct.imageUrl,class:"mt-4 w-full h-80 object-cover object-center"},null,8,ie)):h("",!0),t("div",ce,[de,(r(!0),n(P,null,M(e.tempProduct.imagesUrl,(i,c)=>(r(),n(P,{key:c},[t("div",ae,[ue,m(t("input",{type:"search",id:"mainImgLink",class:"block w-full p-3 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-teal-500 focus:border-teal-500",placeholder:"請輸入圖片網址","onUpdate:modelValue":f=>e.tempProduct.imagesUrl[c]=f},null,8,pe),[[_,e.tempProduct.imagesUrl[c],void 0,{lazy:!0}]])]),d(u,{index:c,onChangeImg:p.changeImage},{main:w(()=>[me]),detail:w(()=>[he]),_:2},1032,["index","onChangeImg"]),e.tempProduct.imagesUrl[c]?(r(),n("img",{key:0,src:e.tempProduct.imagesUrl[c],class:"mt-4 w-full h-80 object-cover object-center"},null,8,ge)):h("",!0),e.tempProduct.imagesUrl[c]?h("",!0):(r(),n("button",{key:1,type:"button",class:"mt-4 admin-delete-button w-full",onClick:f=>e.tempProduct.imagesUrl.splice(c,1)}," 刪除區塊 ",8,fe))],64))),128)),!((l=e.tempProduct.imagesUrl)!=null&&l.length)||e.tempProduct.imagesUrl[e.tempProduct.imagesUrl.length-1]?(r(),n("button",{key:0,type:"button",class:"mt-4 admin-secondary-button w-full",onClick:s[2]||(s[2]=i=>e.tempProduct.imagesUrl.push(""))}," 新增圖片 ")):h("",!0)])]),t("div",_e,[t("div",null,[be,m(t("input",{type:"text",id:"name",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5",required:"","onUpdate:modelValue":s[3]||(s[3]=i=>e.tempProduct.title=i)},null,512),[[_,e.tempProduct.title]])]),t("div",ye,[t("div",null,[we,m(t("select",{id:"modalDistrict",class:"w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block p-2.5","onUpdate:modelValue":s[4]||(s[4]=i=>e.tempProduct.category=i)},xe,512),[[q,e.tempProduct.category]])]),t("div",null,[ve,m(t("input",{type:"text",id:"brand",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5",required:"","onUpdate:modelValue":s[5]||(s[5]=i=>e.tempProduct.brand=i),onChange:s[6]||(s[6]=i=>p.changeAccessory())},null,544),[[_,e.tempProduct.brand,void 0,{lazy:!0}]])])]),t("div",ke,[t("div",null,[Me,m(t("input",{type:"number",id:"origin_price",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5",min:"1",required:"","onUpdate:modelValue":s[7]||(s[7]=i=>e.tempProduct.origin_price=i)},null,512),[[_,e.tempProduct.origin_price,void 0,{lazy:!0}]])]),t("div",null,[Ce,m(t("input",{type:"number",id:"price",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5",min:"1",required:"","onUpdate:modelValue":s[8]||(s[8]=i=>e.tempProduct.price=i)},null,512),[[_,e.tempProduct.price,void 0,{lazy:!0}]])])]),t("div",null,[Ue,t("div",Ie,[(r(!0),n(P,null,M(e.tempProduct.spec,(i,c)=>(r(),n("div",{class:"relative",key:c},[t("div",Ve,[m(t("input",{type:"text",class:"w-[calc(100%-1.9rem)] rounded-l-lg text-sm border-gray-300 focus:ring-violet-300",id:"spec","onUpdate:modelValue":f=>e.tempProduct.spec[c]=f,placeholder:"請輸入規格"},null,8,Ae),[[_,e.tempProduct.spec[c]]]),t("button",{type:"button",class:"absolute w-8 top-0 right-0 px-3 py-2 admin-delete-solid-button rounded-l-none rounded-r-lg border text-sm",onClick:f=>e.tempProduct.spec.splice(c,1)},[d(C,{icon:["fas","xmark"]})],8,Be)])]))),128)),!((y=e.tempProduct.spec)!=null&&y.length)||e.tempProduct.spec[e.tempProduct.spec.length-1]?(r(),n("div",Le,[t("button",{type:"button",class:"admin-secondary-solid-button w-full py-2",onClick:s[9]||(s[9]=i=>e.tempProduct.spec.push(""))}," 新增規格 ")])):h("",!0)])]),e.tempProduct.category!="配件"?(r(),n("div",Te,[Ee,d(U,{modelValue:e.tempProduct.accessory,"onUpdate:modelValue":s[10]||(s[10]=i=>e.tempProduct.accessory=i),label:"name","track-by":"id",multiple:!0,placeholder:e.accessoryPlaceholder,options:e.accessoryOptions,disabled:e.accessoryDisable,class:"mt-2"},null,8,["modelValue","placeholder","options","disabled"])])):h("",!0),t("div",null,[je,d(k,{editor:e.editor,config:e.editorConfig,modelValue:e.tempProduct.description,"onUpdate:modelValue":s[11]||(s[11]=i=>e.tempProduct.description=i)},null,8,["editor","config","modelValue"])]),t("div",null,[Se,d(k,{editor:e.editor,config:e.detailConfig,modelValue:e.tempProduct.content,"onUpdate:modelValue":s[12]||(s[12]=i=>e.tempProduct.content=i)},null,8,["editor","config","modelValue"])]),t("div",De,[Oe,t("div",ze,[(r(!0),n(P,null,M(e.tempProduct.contentImages,(i,c)=>(r(),n("div",{key:c},[t("div",Re,[Ne,m(t("input",{type:"search",id:"mainImgLink",class:"block w-full p-3 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-teal-500 focus:border-teal-500",placeholder:"請輸入圖片網址","onUpdate:modelValue":f=>e.tempProduct.contentImages[c]=f},null,8,He),[[_,e.tempProduct.contentImages[c],void 0,{lazy:!0}]])]),d(u,{index:c,onChangeImg:p.changeImage},{main:w(()=>[qe]),multi:w(()=>[Fe]),_:2},1032,["index","onChangeImg"]),e.tempProduct.contentImages[c]?(r(),n("img",{key:0,src:e.tempProduct.contentImages[c],class:"mt-4 w-full h-36 object-cover object-center rounded"},null,8,Xe)):h("",!0),e.tempProduct.contentImages[c]?h("",!0):(r(),n("button",{key:1,type:"button",class:"mt-4 admin-delete-button w-full",onClick:f=>e.tempProduct.contentImages.splice(c,1)}," 刪除區塊 ",8,Ge))]))),128)),!((V=e.tempProduct.contentImages)!=null&&V.length)||e.tempProduct.contentImages[e.tempProduct.contentImages.length-1]?(r(),n("button",{key:0,type:"button",class:"admin-secondary-button w-full h-11",onClick:s[13]||(s[13]=i=>e.tempProduct.contentImages.push(""))}," 新增圖片 ")):h("",!0)])]),t("div",Je,[t("div",Ke,[t("label",Qe,[m(t("input",{type:"checkbox",class:"sr-only peer","true-value":1,"false-value":0,checked:e.tempProduct.is_enabled,"onUpdate:modelValue":s[14]||(s[14]=i=>e.tempProduct.is_enabled=i)},null,8,We),[[I,e.tempProduct.is_enabled]]),Ye,Ze])]),t("div",$e,[t("button",{type:"button",class:"admin-delete-button",onClick:s[15]||(s[15]=()=>{o.productModal.hide(),e.tempProduct.brand=""})}," 取消 "),t("button",{type:"button",class:"ml-6 admin-primary-button",disabled:!e.tempProduct.imageUrl||!e.tempProduct.title||!e.tempProduct.brand||!e.tempProduct.category||!e.tempProduct.origin_price||!e.tempProduct.price,title:[!e.tempProduct.imageUrl||!e.tempProduct.title||!e.tempProduct.brand||!e.tempProduct.category||!e.tempProduct.origin_price||!e.tempProduct.price?'"*"號為必填欄位':""],onClick:s[16]||(s[16]=i=>p.updateProduct())}," 確認 ",8,et)])])])])])])],512)}const st=S(G,[["render",tt]]),{VITE_API:L,VITE_PATH:T}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"metaverspace",BASE_URL:"/MetaverSpace",MODE:"production",DEV:!1,PROD:!0,SSR:!1},ot={mixins:[D],data(){return{ascending:!1,sortBy:"",allProducts:[],products:[],pagination:{},showAccessory:!0,accessories:[],productLoading:[]}},methods:{getProducts(o=1,s){this.accessories=[],this.loadings.fullLoading=!0,this.$http.get(`${L}/api/${T}/admin/products/all`).then(a=>{this.allProducts=Object.values(a.data.products).reverse(),this.showAccessory||(this.allProducts=this.allProducts.filter(e=>e.category!=="配件")),this.products=this.allProducts.filter((e,p)=>Math.ceil((p+1)/10)==o),this.accessories=Object.values(a.data.products).filter(e=>e.category==="配件");const v=Math.ceil(Object.keys(this.allProducts).length/10);this.pagination={total_pages:v,current_page:o,has_pre:o!==1,has_next:o!==v},this.loadings.fullLoading=!1,s==="update"?this.adminToast("success","已更新商品資料"):s==="delete"&&this.adminToast("success","已刪除商品資料")}).catch(a=>{this.loadings.fullLoading=!1,this.adminToast("error",a.response.data.message)})},changePages(o=1){this.products=Object.values(this.allProducts).filter((s,a)=>Math.ceil((a+1)/10)==o),this.pagination.current_page=o,this.pagination.has_pre=o!==1,this.pagination.has_next=o!==this.pagination.total_pages,window.scrollTo({top:0,behavior:"smooth"})},updateEnable(o){this.productLoading.push(o.id),this.$http.put(`${L}/api/${T}/admin/product/${o.id}`,{data:o}).then(()=>{this.productLoading.shift(),this.adminToast("success","已更新啟用狀態")}).catch(s=>{this.productLoading.shift(),this.adminToast("error",s.response.data.message),this.getProducts(this.page.current_page)})}},mounted(){this.productModal=this.$refs.productModal,this.deleteModal=this.$refs.deleteModal,this.getProducts()},computed:{...E(j,["loadings"]),sortProducts(){return this.sortBy==="category"||this.sortBy==="brand"?[...this.products].sort((o,s)=>this.ascending?o[this.sortBy].localeCompare(s[this.sortBy],"zh-hant"):s[this.sortBy].localeCompare(o[this.sortBy],"zh-hant")):this.sortBy?[...this.products].sort((o,s)=>this.ascending?o[this.sortBy]-s[this.sortBy]:s[this.sortBy]-o[this.sortBy]):this.products}},components:{Pagination:O,ProductModal:st,DeleteModal:z}},rt={class:"mt-8 px-6"},nt={class:"flex justify-between items-center"},lt={class:"flex"},it={class:"relative inline-flex items-center cursor-pointer"},ct=["checked"],dt=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-teal-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-teal-600"},null,-1),at=t("span",{class:"ml-3 text-md font-medium text-gray-900"},"顯示配件",-1),ut={class:"mt-6 relative overflow-x-auto shadow-md sm:rounded-lg"},pt={class:"w-full text-md text-left text-gray-700"},mt={class:"text-sm text-dark uppercase bg-gray-300"},ht=t("th",{scope:"col",class:"sr-only"},"Loading",-1),gt={key:0,class:"text-xs"},ft={key:0},_t={key:1},bt={key:1},yt={key:0},wt={key:0},Pt={key:1},xt={key:1},vt={key:0,class:"text-xs"},kt={key:0},Mt={key:1},Ct={key:1},Ut=t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},"商品名稱",-1),It=t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},"原價",-1),Vt={key:0,class:"text-xs"},At={key:0},Bt={key:1},Lt={key:1},Tt=t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},[t("span",{class:"sr-only"},"選項")],-1),Et={class:"px-3 w-6 max-w-[1.5rem]"},jt={key:0,class:"animate-spin h-5 w-5 mr-3 text-dark",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},St=t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),Dt=t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),Ot=[St,Dt],zt={class:"px-6 font-medium whitespace-nowrap"},Rt={class:"w-9"},Nt=["disabled","checked","onUpdate:modelValue","onChange"],Ht=t("div",{class:"w-full h-5 bg-gray-500 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-teal-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all border-gray-300 peer-checked:bg-teal-600"},null,-1),qt={class:"px-6 py-4 whitespace-nowrap"},Ft={class:"px-6 py-4 whitespace-nowrap"},Xt={class:"px-6 py-4 whitespace-nowrap"},Gt={class:"px-6 py-4 whitespace-nowrap"},Jt={class:"px-6 py-4 whitespace-nowrap"},Kt={class:"px-6 py-4 whitespace-nowrap flex justify-center space-x-6"},Qt=["disabled","onClick"],Wt=["disabled","onClick"];function Yt(o,s,a,v,e,p){const u=b("font-awesome-icon"),C=b("Pagination"),U=b("ProductModal"),k=b("DeleteModal");return r(),n(P,null,[t("div",rt,[t("div",nt,[t("button",{type:"button",class:"admin-primary-button",onClick:s[0]||(s[0]=l=>o.productModal.openModal("new"))}," 新增商品 "),t("div",lt,[t("label",it,[m(t("input",{type:"checkbox",class:"sr-only peer",checked:e.showAccessory,"onUpdate:modelValue":s[1]||(s[1]=l=>e.showAccessory=l),onChange:s[2]||(s[2]=l=>p.getProducts())},null,40,ct),[[I,e.showAccessory]]),dt,at])])]),t("div",ut,[t("table",pt,[t("thead",mt,[t("tr",null,[ht,t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap cursor-pointer",onClick:s[3]||(s[3]=l=>{e.sortBy="is_enabled",e.ascending=e.sortBy==="is_enabled"?!e.ascending:!0})},[g(" 上架 "),e.sortBy==="is_enabled"?(r(),n("span",gt,[e.ascending?(r(),n("span",ft,[d(u,{icon:["fas","sort-up"]})])):(r(),n("span",_t,[d(u,{icon:["fas","sort-down"]})]))])):(r(),n("span",bt,[d(u,{icon:["fas","sort"]})]))]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap cursor-pointer",onClick:s[4]||(s[4]=l=>{e.sortBy="category",e.ascending=e.sortBy==="category"?!e.ascending:!0})},[g(" 類別 "),e.sortBy==="category"?(r(),n("span",yt,[e.ascending?(r(),n("span",wt,[d(u,{icon:["fas","sort-up"]})])):(r(),n("span",Pt,[d(u,{icon:["fas","sort-down"]})]))])):(r(),n("span",xt,[d(u,{icon:["fas","sort"]})]))]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap cursor-pointer",onClick:s[5]||(s[5]=l=>{e.sortBy="brand",e.ascending=e.sortBy==="brand"?!e.ascending:!0})},[g(" 品牌 "),e.sortBy==="brand"?(r(),n("span",vt,[e.ascending?(r(),n("span",kt,[d(u,{icon:["fas","sort-up"]})])):(r(),n("span",Mt,[d(u,{icon:["fas","sort-down"]})]))])):(r(),n("span",Ct,[d(u,{icon:["fas","sort"]})]))]),Ut,It,t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap cursor-pointer",onClick:s[6]||(s[6]=l=>{e.sortBy="price",e.ascending=e.sortBy==="price"?!e.ascending:!0})},[g(" 售價 "),e.sortBy==="price"?(r(),n("span",Vt,[e.ascending?(r(),n("span",At,[d(u,{icon:["fas","sort-up"]})])):(r(),n("span",Bt,[d(u,{icon:["fas","sort-down"]})]))])):(r(),n("span",Lt,[d(u,{icon:["fas","sort"]})]))]),Tt])]),t("tbody",null,[(r(!0),n(P,null,M(p.sortProducts,l=>(r(),n("tr",{class:"bg-white border-b hover:bg-teal-100",key:l.id},[t("td",Et,[e.productLoading.indexOf(l.id)>-1?(r(),n("svg",jt,Ot)):h("",!0)]),t("td",zt,[t("div",Rt,[t("label",{class:X(["relative",e.productLoading.indexOf(l.id)>-1?"cursor-not-allowed":" cursor-pointer"])},[m(t("input",{type:"checkbox",class:"sr-only peer disabled:ring-4","true-value":1,"false-value":0,disabled:e.productLoading.indexOf(l.id)>-1,checked:l.is_enabled,"onUpdate:modelValue":y=>l.is_enabled=y,onChange:y=>p.updateEnable(l)},null,40,Nt),[[I,l.is_enabled]]),Ht],2)])]),t("td",qt,x(l.category),1),t("td",Ft,x(l.brand),1),t("td",Xt,x(l.title),1),t("td",Gt,x(o.$filters.currency(l.origin_price)),1),t("td",Jt,x(o.$filters.currency(l.price)),1),t("td",Kt,[t("button",{type:"button",disabled:e.productLoading.indexOf(l.id)>-1,class:"admin-secondary-button px-3.5 py-1.5",onClick:y=>o.productModal.openModal("edit",l)}," 編輯 ",8,Qt),t("button",{type:"button",disabled:e.productLoading.indexOf(l.id)>-1,class:"admin-delete-button px-3.5 py-1.5",onClick:y=>o.deleteModal.openModal("商品",l)}," 刪除 ",8,Wt)])]))),128))])])]),d(C,{class:"mt-8","page-obj":e.pagination,onEmitPage:p.changePages},null,8,["page-obj","onEmitPage"])]),d(U,{ref:"productModal",page:e.pagination.current_page,accessories:e.accessories,onUpdateProducts:p.getProducts},null,8,["page","accessories","onUpdateProducts"]),d(k,{ref:"deleteModal",page:e.products.length>1?e.pagination.current_page:e.pagination.current_page-1,onUpdateProducts:p.getProducts},null,8,["page","onUpdateProducts"])],64)}const os=S(ot,[["render",Yt]]);export{os as default};
