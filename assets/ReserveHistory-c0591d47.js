import{a as b,l as E,_ as g,o,c,b as e,F as v,g as R,t as d,f as m,d as n,w as $,j as k,r as p,n as f,h as T}from"./index-bcb3825a.js";import{s as V}from"./swal-e4da1902.js";const{VITE_RENDER_API:D}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"metaverspace",VITE_RENDER_API:"https://metarverspace-server.onrender.com",BASE_URL:"/MetaverSpace/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},S={props:["reserves"],methods:{deleteReserve(t){this.$swal.fire({title:"取消預約",text:`確定要取消 ${new Date(t.reserve_time).toLocaleString("zh-TW",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})} 的預約？`,icon:"warning",confirmButtonColor:"#FE5F50",confirmButtonText:"確定取消",backdrop:" rgba(0,0,0,0.8)",showCancelButton:!0,cancelButtonColor:"#6b7280"}).then(i=>{i.isConfirmed&&(this.loadings.fullLoading=!0,this.$http.delete(`${D}/reserves/${t.id}`).then(()=>{this.$emit("update-reserves",t.id),this.loadings.fullLoading=!1}).catch(a=>{this.loadings.fullLoading=!1,this.userToast("error",a.message)}))})}},computed:{...b(E,["loadings"])}},I={key:0,class:"text-center text-2xl md:text-3xl mb-10"},L={key:1,class:"mb-10"},C={class:"relative overflow-x-auto sm:rounded-lg"},A={class:"w-full text-sm text-left"},B=e("thead",{class:"uppercase bg-white/20 text-gray-300"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},"預約時間"),e("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},"門市"),e("th",{scope:"col",class:"px-4 py-3 whitespace-nowrap"},"預約人數"),e("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},"預約人姓名"),e("th",{scope:"col",class:"px-5 py-3 whitespace-nowrap"},"預約狀態"),e("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"},[e("span",{class:"sr-only"},"選項")])])],-1),P={class:"border-b bg-gray-800 border-gray-700"},N={scope:"row",class:"px-6 py-4 font-medium whitespace-nowrap text-white"},F={class:"px-6 py-4 whitespace-nowrap"},M={class:"px-4 py-4 whitespace-nowrap"},z={class:"px-6 py-4 whitespace-nowrap"},O={class:"px-5 py-4 whitespace-nowrap"},q={class:"px-5 py-4 whitespace-nowrap flex justify-center"},H=["onClick"];function U(t,i,a,l,r,h){return a.reserves.length?(o(),c("div",L,[e("div",C,[e("table",A,[B,(o(!0),c(v,null,R(a.reserves,s=>(o(),c("tbody",{key:s.id,class:"text-sm text-gray-400"},[e("tr",P,[e("th",N,d(new Date(s.reserve_time).toLocaleString("zh-TW",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})),1),e("td",F,d(s.title),1),e("td",M,d(s.num),1),e("td",z,d(s.name),1),e("td",O,d(s.is_reserve?"預約成功":"尚未確認"),1),e("td",q,[s.is_reserve?m("",!0):(o(),c("button",{key:0,type:"button",class:"text-white right-1.5 bottom-1.5 focus:ring-1 focus:outline-none font-medium rounded text-sm px-4 py-2 bg-warm hover:bg-warm2 focus:ring-warm2",onClick:_=>h.deleteReserve(s)}," 取消預約 ",8,H))])])]))),128))])])])):(o(),c("p",I," 沒有任何預約記錄 "))}const j=g(S,[["render",U]]),{VITE_RENDER_API:W}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"metaverspace",VITE_RENDER_API:"https://metarverspace-server.onrender.com",BASE_URL:"/MetaverSpace/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},G={mixins:[V],data(){return{searchLoading:!1,reserves:[],filterReserves:[]}},methods:{getReserves(t){const i=t.姓名.trim(),a=t.電話或Email.trim();this.searchLoading=!0,this.$http.get(`${W}/reserves`).then(l=>{this.reserves=l.data,this.filterReserves=this.reserves.filter(r=>r.name===i&&(r.email===a||r.tel===a)),this.searchLoading=!1}).catch(l=>{this.searchLoading=!1,this.userToast("error",l.message)})},updateReserves(t){this.filterReserves=this.filterReserves.filter(i=>i.id!==t),this.userToast("success","取消預約成功")}},components:{ReserveDetail:j}},J={class:"mt-nav"},K={class:"container px-2 md:px-0 pt-8"},Q={class:"border-2 rounded-lg overflow-hidden"},X=e("h1",{class:"p-4 bg-black/50 text-xl font-bold border-b-2"},"預約記錄",-1),Y={class:"px-8"},Z={class:"py-8 flex justify-center"},ee=e("label",{for:"name",class:"block mb-2 text-sm font-medium text-white"},"姓名",-1),se={class:"mt-8"},te=e("label",{for:"phoneOrEmail",class:"block mb-2 text-sm font-medium text-white"},"電話或Email",-1),re=["disabled"],oe={key:0,class:"animate-spin h-5 w-5 mr-3 text-white absolute",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ae=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),ce=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),ie=[ae,ce],ne={key:0,class:"my-20 border-b border-2"};function le(t,i,a,l,r,h){const s=p("VField"),_=p("ErrorMessage"),x=p("VForm"),w=p("ReserveDetail"),y=p("ScrollTop");return o(),c(v,null,[e("div",J,[e("div",K,[e("div",Q,[X,e("div",Y,[e("div",Z,[n(x,{class:"w-96",ref:"form",onSubmit:h.getReserves},{default:$(({errors:u})=>[e("div",null,[ee,n(s,{type:"text",id:"name",name:"姓名",class:f(["border text-sm rounded-lg block w-full p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-primary focus:border-primary",{"border-warm":u.姓名}]),rules:"required",placeholder:"請輸入姓名",required:""},null,8,["class"]),n(_,{name:"姓名",class:"text-warm text-sm"})]),e("div",se,[te,n(s,{type:"text",id:"name",name:"電話或Email",class:f(["border text-sm rounded-lg block w-full p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-primary focus:border-primary",{"border-warm":u.電話或Email}]),rules:"required",placeholder:"請輸入電話或Email",required:""},null,8,["class"]),n(_,{name:"電話或Email",class:"text-warm text-sm"})]),e("button",{type:"submit",class:"mt-12 primary-button w-full relative",disabled:r.searchLoading},[r.searchLoading?(o(),c("svg",oe,ie)):m("",!0),T(" 預約查詢 ")],8,re)]),_:1},8,["onSubmit"])])])]),r.reserves.length?(o(),c("div",ne)):m("",!0),r.reserves.length?(o(),k(w,{key:1,reserves:r.filterReserves,onUpdateReserves:h.updateReserves},null,8,["reserves","onUpdateReserves"])):m("",!0)])]),n(y)],64)}const he=g(G,[["render",le]]);export{he as default};
